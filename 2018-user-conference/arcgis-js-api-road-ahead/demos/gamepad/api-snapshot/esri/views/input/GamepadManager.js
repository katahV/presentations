// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(g,h,k,e,l,d){Object.defineProperty(h,"__esModule",{value:!0});g=function(g){function b(){var a=g.call(this)||this;a._filteredGamepads=[];a._idleTimer=null;a._idleTransformation={translation:[0,0,0],heading:0,tilt:0};a.device=null;a.sensitivity=1;a.invertX=!1;a.invertY=!0;a.perspective="first-person";a.mode="hover";a.isIdle=
!0;return a}k(b,g);b.prototype.destroy=function(){this._idleTransformation=this._filteredGamepads=null;this._idleTimer&&(clearInterval(this._idleTimer),this._idleTimer=0)};Object.defineProperty(b.prototype,"enabled",{get:function(){return this._get("enabled")},set:function(a){var c=this;this._set("enabled",a);a?(this._set("isIdle",!1),this._idleTimer&&(clearInterval(this._idleTimer),this._idleTimer=0),this._idleTimer=setInterval(function(){c.updateTransformation(c._idleTransformation);0===c._idleTransformation.translation[0]&&
0===c._idleTransformation.translation[1]&&0===c._idleTransformation.translation[2]&&0===c._idleTransformation.heading&&0===c._idleTransformation.tilt?c._set("isIdle",!0):c._set("isIdle",!1)},100)):(this._set("isIdle",!0),this._idleTimer&&(clearInterval(this._idleTimer),this._idleTimer=0))},enumerable:!0,configurable:!0});b.prototype.updateTransformation=function(a){var c=this.getGamepads();if(!c||0===c.length)return a.translation=[0,0,0],a.heading=0,a.tilt=0,a;var f=null;if(!this.device||0>this.device)f=
c[0];else{for(var b=0;b<c.length;b++)if(c[b].index===this.device){f=c[b];break}f||(f=c[0])}var c=this._quadratic(f.axes[0]),b=this._quadratic(f.axes[1]),d=this._quadratic(f.axes[2]),e=this._quadratic(f.axes[3]),f=(f.buttons[4].pressed?-1:0)+(f.buttons[5].pressed?1:0);this.invertX&&(d=-d);this.invertY&&(e=-e);c*=this.sensitivity;b*=this.sensitivity;f*=this.sensitivity;a.translation=[c,b,f];a.heading=d;a.tilt=e;return a};b.prototype.getGamepads=function(){for(var a=navigator.getGamepads(),c=this._filteredGamepads.length=
0;c<a.length;++c){var b=a[c];b&&b.connected&&"standard"===b.mapping&&this._filteredGamepads.push(b)}return this._filteredGamepads};b.prototype._quadratic=function(a){if(.15>Math.abs(a))return 0;var b=a*a;0>a&&(b*=-1);return b};e([d.property({type:Boolean,value:!1})],b.prototype,"enabled",null);e([d.property({type:Number})],b.prototype,"device",void 0);e([d.property({type:Number}),d.cast(function(a){return Math.min(Math.max(a,.1),10)})],b.prototype,"sensitivity",void 0);e([d.property({type:Boolean})],
b.prototype,"invertX",void 0);e([d.property({type:Boolean})],b.prototype,"invertY",void 0);e([d.property({type:String})],b.prototype,"perspective",void 0);e([d.property({type:String})],b.prototype,"mode",void 0);e([d.property({readOnly:!0,type:Boolean})],b.prototype,"isIdle",void 0);return b=e([d.subclass("esri.views.input.GamepadManager")],b)}(d.declared(l));h.GamepadManager=g});