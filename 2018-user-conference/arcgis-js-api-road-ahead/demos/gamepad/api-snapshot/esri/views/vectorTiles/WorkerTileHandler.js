// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/vectorTiles/WorkerTile":function(){define("require exports dojo/Deferred ../../core/executeAsync ../../core/ObjectPool ../../core/promiseUtils ./BackgroundBucket ./CircleBucket ./FillBucket ./GeometryUtils ./IndexMemoryBuffer ./LineBucket ./Placement ./SymbolBucket ./TileParser ./VertexMemoryBuffer".split(" "),function(q,a,b,p,m,f,l,c,e,h,d,r,z,A,D,n){return function(){function a(){this.status=this.rotation=0;this._symbolBuckets=[];this.placementEngine=new z.PlacementEngine;
this.fillVertexBuffer=new n.FillVertexBuffer(!1);this.fillDDVertexBuffer=new n.FillVertexBuffer(!0);this.fillIndexBuffer=new d.TriangleIndexBuffer;this.outlineVertexBuffer=new n.OutlineVertexBuffer(!1);this.outlineDDVertexBuffer=new n.OutlineVertexBuffer(!0);this.outlineIndexBuffer=new d.TriangleIndexBuffer;this.lineVertexBuffer=new n.LineVertexBuffer(!1);this.lineDDVertexBuffer=new n.LineVertexBuffer(!0);this.lineIndexBuffer=new d.TriangleIndexBuffer;this.iconVertexBuffer=new n.SymbolVertexBuffer(!1);
this.iconDDVertexBuffer=new n.SymbolVertexBuffer(!0);this.iconIndexBuffer=new d.TriangleIndexBuffer;this.textVertexBuffer=new n.SymbolVertexBuffer(!1);this.textDDVertexBuffer=new n.SymbolVertexBuffer(!0);this.textIndexBuffer=new d.TriangleIndexBuffer;this.circleVertexBuffer=new n.CircleVertexBuffer;this.circleIndexBuffer=new d.TriangleIndexBuffer}a.prototype.initialize=function(d,c,a,e){void 0===e&&(e=0);this.tileKey=d;this.refKey=c;this._workerTileHandler=a;this.rotation=e;this.placementEngine.setAngle(h.C_DEG_TO_RAD*
e)};a.prototype.release=function(){this.tileKey=this.refKey="";this.rotation=this.status=0;this.fillVertexBuffer.reset();this.fillDDVertexBuffer.reset();this.fillIndexBuffer.reset();this.outlineVertexBuffer.reset();this.outlineDDVertexBuffer.reset();this.outlineIndexBuffer.reset();this.lineVertexBuffer.reset();this.lineDDVertexBuffer.reset();this.lineIndexBuffer.reset();this.iconVertexBuffer.reset();this.iconDDVertexBuffer.reset();this.iconIndexBuffer.reset();this.textVertexBuffer.reset();this.textDDVertexBuffer.reset();
this.textIndexBuffer.reset();this.circleVertexBuffer.reset();this.circleIndexBuffer.reset();this.placementEngine.reset();this._symbolBuckets.length=0;this._workerTileHandler=null};a.prototype.setDataAndParse=function(d,a){var h=this,m=new b(function(d){h.status=6});this._parse(d,a).then(function(d){h.status=4;for(var a=new Uint32Array([1,h.fillVertexBuffer.sizeInBytes,2,h.fillDDVertexBuffer.sizeInBytes,3,h.fillIndexBuffer.sizeInBytes,4,h.outlineVertexBuffer.sizeInBytes,5,h.outlineDDVertexBuffer.sizeInBytes,
6,h.outlineIndexBuffer.sizeInBytes,7,h.lineVertexBuffer.sizeInBytes,8,h.lineDDVertexBuffer.sizeInBytes,9,h.lineIndexBuffer.sizeInBytes,10,h.iconVertexBuffer.sizeInBytes,11,h.iconDDVertexBuffer.sizeInBytes,12,h.iconIndexBuffer.sizeInBytes,13,h.textVertexBuffer.sizeInBytes,14,h.textDDVertexBuffer.sizeInBytes,15,h.textIndexBuffer.sizeInBytes,16,h.circleVertexBuffer.sizeInBytes,17,h.circleIndexBuffer.sizeInBytes]),n=[],f=d.length,v=0;v<f;v++){var b=d[v];if(b instanceof e)n.push(b.layerIndex),n.push(1),
n.push(b.fillIndexStart),n.push(b.fillIndexCount),n.push(b.outlineIndexStart),n.push(b.outlineIndexCount);else if(b instanceof r)n.push(b.layerIndex),n.push(2),n.push(b.lineIndexStart),n.push(b.lineIndexCount);else if(b instanceof A){n.push(b.layerIndex);n.push(3);n.push(b.sdfMarker?1:0);var p=b.markerPageMap;n.push(p.size);p.forEach(function(d,c){n.push(c);n.push(d[0]);n.push(d[1])});b=b.glyphsPageMap;n.push(b.size);b.forEach(function(d,c){n.push(c);n.push(d[0]);n.push(d[1])})}else b instanceof c?
(n.push(b.layerIndex),n.push(4),n.push(b.circleIndexStart),n.push(b.circleIndexCount)):b instanceof l&&(n.push(b.layerIndex),n.push(0))}d=new Uint32Array(n);var f=h.fillVertexBuffer.toBuffer(),v=h.fillDDVertexBuffer.toBuffer(),b=h.fillIndexBuffer.toBuffer(),p=h.outlineVertexBuffer.toBuffer(),z=h.outlineDDVertexBuffer.toBuffer(),D=h.outlineIndexBuffer.toBuffer(),y=h.lineVertexBuffer.toBuffer(),x=h.lineDDVertexBuffer.toBuffer(),w=h.lineIndexBuffer.toBuffer(),I=h.iconVertexBuffer.toBuffer(),F=h.iconDDVertexBuffer.toBuffer(),
J=h.iconIndexBuffer.toBuffer(),C=h.textVertexBuffer.toBuffer(),B=h.textDDVertexBuffer.toBuffer(),V=h.textIndexBuffer.toBuffer(),Z=h.circleVertexBuffer.toBuffer(),q=h.circleIndexBuffer.toBuffer();m.resolve({result:{bufferDataInfo:a.buffer,bucketDataInfo:d.buffer,bufferData:[f,v,b,p,z,D,y,x,w,I,F,J,C,B,V,Z,q]},transferList:[f,v,b,p,z,D,y,x,w,I,F,J,C,B,V,Z,q,a.buffer,d.buffer]})});return m.promise};a.prototype.addBucket=function(d){this._symbolBuckets.push(d)};a.prototype.updateSymbols=function(d){var c=
this,a=this._symbolBuckets;if(!a||0===a.length)return f.resolve();this.rotation=d;var e=this.placementEngine;e.reset();e.setAngle(d/256*360*h.C_DEG_TO_RAD);var r=this.iconVertexBuffer;r.reset();var n=this.iconDDVertexBuffer;n.reset();var m=this.iconIndexBuffer;m.reset();var l=this.textVertexBuffer;l.reset();var b=this.textDDVertexBuffer;b.reset();var z=this.textIndexBuffer;z.reset();var D=[],A=a.length,x=0;return p(function(){if(6===c.status||0===c.status)return!0;if(x<A){var d=a[x++],h=d.layer;if(d=
d.copy(h.hasDataDrivenIcon?n:r,m,h.hasDataDrivenText?b:l,z,e))D.push(d),d.updateSymbols()}return x>=A}).then(function(){if(6===c.status||0===c.status||0===r.sizeInBytes&&0===n.sizeInBytes&&0===m.sizeInBytes&&0===l.sizeInBytes&&0===b.sizeInBytes&&0===z.sizeInBytes)return{result:null,transferList:null};var d=new Uint32Array([10,r.sizeInBytes,11,n.sizeInBytes,12,m.sizeInBytes,13,l.sizeInBytes,14,b.sizeInBytes,15,z.sizeInBytes]),a=[];A=D.length;for(var e=0;e<A;e++){var h=D[e];a.push(h.layerIndex);a.push(3);
a.push(h.sdfMarker?1:0);var f=h.markerPageMap;a.push(f.size);f.forEach(function(d,c){a.push(c);a.push(d[0]);a.push(d[1])});h=h.glyphsPageMap;a.push(h.size);h.forEach(function(d,c){a.push(c);a.push(d[0]);a.push(d[1])})}var e=new Uint32Array(a),h=r.toBuffer(),f=n.toBuffer(),v=m.toBuffer(),p=l.toBuffer(),y=b.toBuffer(),x=z.toBuffer();return{result:{bufferDataInfo:d.buffer,bucketDataInfo:e.buffer,bufferData:[h,f,v,p,y,x]},transferList:[h,f,v,p,y,x,d.buffer,e.buffer]}}).catch(function(){return null})};
a.prototype.setObsolete=function(){this.status=6};a.prototype.getLayers=function(){return this._workerTileHandler.getLayers()};a.prototype.getWorkerTileHandler=function(){return this._workerTileHandler};a.prototype._parse=function(d,a){if(!d||0===d.byteLength)return f.resolve([]);this.status=2;return(new D(d,this,a)).parse()};a.pool=new m(a);return a}()})},"esri/core/executeAsync":function(){define("require exports dojo/has ./nextTick ./now ./promiseUtils".split(" "),function(q,a,b,p,m,f){function l(){var a=
0===e.length;if(!a){for(var b=m();!a&&m()-b<c;){var f=e[d];if(f){if(!0===f()){var D=h.get(f);e[d]=null;h.delete(f);D()}d=(d+1)%e.length}else e.splice(d,1),d=(a=0===e.length)?0:d%e.length}a||p(l)}}var c=b("host-browser")?6:200,e=[],h=new Map,d=0;return function(d){return d?f.create(function(a){e.push(d);h.set(d,a);1===e.length&&p(l)},function(){e[e.indexOf(d)]=null;h.delete(d)}):f.reject(new TypeError("callback is not a function"))}})},"esri/core/nextTick":function(){define(["require","exports","./global"],
function(q,a,b){function p(){if(b.postMessage&&!b.importScripts){var a=b.onmessage,m=!0;b.onmessage=function(){m=!1};b.postMessage("","*");b.onmessage=a;return m}return!1}var m=b.MutationObserver||b.WebKitMutationObserver;return function(){var a;if(b.process&&b.process.nextTick)a=function(a){b.process.nextTick(a)};else if(b.Promise)a=function(a){b.Promise.resolve().then(a)};else if(m){var l=[],c=document.createElement("div");(new m(function(){for(;0<l.length;)l.shift()()})).observe(c,{attributes:!0});
a=function(a){l.push(a);c.setAttribute("queueStatus","1")}}else if(p()){var e=[];b.addEventListener("message",function(a){if(a.source===b&&"esri-nexttick-message"===a.data)for(a.stopPropagation();e.length;)e.shift()()},!0);a=function(a){e.push(a);b.postMessage("esri-nexttick-message","*")}}else a=b.setImmediate?function(a){return b.setImmediate(a)}:function(a){return b.setTimeout(a,0)};return a}()})},"esri/core/now":function(){define(["require","exports","./global"],function(q,a,b){return function(){var a=
b.performance||{};if(a.now)return function(){return a.now()};if(a.webkitNow)return function(){return a.webkitNow()};if(a.mozNow)return function(){return a.mozNow()};if(a.msNow)return function(){return a.msNow()};if(a.oNow)return function(){return a.oNow()};var m;m=a.timing&&a.timing.navigationStart?a.timing.navigationStart:Date.now();return function(){return Date.now()-m}}()})},"esri/core/ObjectPool":function(){define(["require","exports"],function(q,a){var b=function(){return function(){}}();return function(){function a(a,
b,l,c,e){void 0===c&&(c=1);void 0===e&&(e=0);this.classConstructor=a;this.acquireFunctionOrWithConstructor=b;this.releaseFunction=l;this.growthSize=c;!0===b?this.acquireFunction=this._constructorAcquireFunction:"function"===typeof b&&(this.acquireFunction=b);this._pool=Array(e);this._set=new Set;this._initialSize=e;for(a=0;a<e;a++)this._pool[a]=new this.classConstructor;this.growthSize=Math.max(c,1)}a.prototype.acquire=function(){for(var a=[],f=0;f<arguments.length;f++)a[f]=arguments[f];f=this.classConstructor||
b;if(0===this._pool.length)for(var l=this.growthSize,c=0;c<l;c++)this._pool[c]=new f;f=this._pool.shift();this.acquireFunction?this.acquireFunction.apply(this,[f].concat(a)):f&&f.acquire&&"function"===typeof f.acquire&&f.acquire.apply(f,a);this._set.delete(f);return f};a.prototype.release=function(a){a&&!this._set.has(a)&&(this.releaseFunction?this.releaseFunction(a):a&&a.release&&"function"===typeof a.release&&a.release(),this._pool.push(a),this._set.add(a))};a.prototype.prune=function(){if(!(this._pool.length<=
this._initialSize))for(var a;this._initialSize>this._pool.length;)a=this._pool.shift(),this._set.delete(a),a.dispose&&"function"===typeof a.dispose&&a.dispose()};a.prototype._constructorAcquireFunction=function(a){for(var b=[],l=1;l<arguments.length;l++)b[l-1]=arguments[l];(c=this.classConstructor).call.apply(c,[a].concat(b));var c};return a}()})},"esri/views/vectorTiles/BackgroundBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper",
"./Bucket"],function(q,a,b,p,m){return function(a){function l(c,e){return a.call(this,c,e)||this}b(l,a);return l}(m)})},"esri/core/tsSupport/decorateHelper":function(){define([],function(){return function(q,a,b,p){var m=arguments.length,f=3>m?a:null===p?p=Object.getOwnPropertyDescriptor(a,b):p,l;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(q,a,b,p);else for(var c=q.length-1;0<=c;c--)if(l=q[c])f=(3>m?l(f):3<m?l(a,b,f):l(a,b))||f;return 3<m&&f&&Object.defineProperty(a,
b,f),f}})},"esri/views/vectorTiles/Bucket":function(){define(["require","exports"],function(q,a){return function(){function a(a,b){this.layerExtent=4096;this._features=[];this.layer=a;this.zoom=b;this._filter=a.getFeatureFilter()}a.prototype.pushFeature=function(a){this._filter.filter(a)&&this._features.push(a)};a.prototype.hasFeatures=function(){return 0<this._features.length};a.prototype.processFeatures=function(a,b){};a.prototype.assignBufferInfo=function(a){};return a}()})},"esri/views/vectorTiles/CircleBucket":function(){define(["require",
"exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./Bucket"],function(q,a,b,p,m){return function(a){function l(c,e,h,d){c=a.call(this,c,e)||this;c._circleVertexBuffer=h;c._circleIndexBuffer=d;return c}b(l,a);Object.defineProperty(l.prototype,"circleIndexStart",{get:function(){return this._circleIndexStart},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"circleIndexCount",{get:function(){return this._circleIndexCount},enumerable:!0,configurable:!0});
l.prototype.assignBufferInfo=function(a){a._circleIndexStart=this._circleIndexStart;a._circleIndexCount=this._circleIndexCount};l.prototype.processFeatures=function(a,e){e=this._circleVertexBuffer;var c=this._circleIndexBuffer;this._circleIndexStart=c.index;this._circleIndexCount=0;var d=this.layer,r=this.zoom;a&&a.setExtent(this.layerExtent);for(var l=1,b=[1,1,1,1],m=1,n=0,f=1,p=[1,1,1,1],B=1,C=0,y=this._features;C<y.length;C++){var v=y[C],u=v.getGeometry(a);if(u)for(d.hasDataDrivenRadius&&(l=d.getPaintValue("circle-radius",
r,v)),d.hasDataDrivenColor&&(b=d.getPaintValue("circle-color",r,v)),d.hasDataDrivenOpacity&&(m=d.getPaintValue("circle-opacity",r,v)),d.hasDataDrivenStrokeWidth&&(f=d.getPaintValue("circle-stroke-width",r,v)),d.hasDataDrivenStrokeColor&&(p=d.getPaintValue("circle-stroke-color",r,v)),d.hasDataDrivenStrokeOpacity&&(B=d.getPaintValue("circle-stroke-opacity",r,v)),d.hasDataDrivenBlur&&(n=d.getPaintValue("circle-blur",r,v)),v=0;v<u.length;v++){var E=u[v];if(E)for(var H=0;H<E.length;H++){var P=E[H],O=e.index;
e.add(P.x,P.y,0,0,l,b,m,n,f,p,B);e.add(P.x,P.y,0,1,l,b,m,n,f,p,B);e.add(P.x,P.y,1,0,l,b,m,n,f,p,B);e.add(P.x,P.y,1,1,l,b,m,n,f,p,B);c.add(O+0,O+1,O+2);c.add(O+1,O+2,O+3);this._circleIndexCount+=6}}}};return l}(m)})},"esri/views/vectorTiles/FillBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/ArrayPool ../../core/libs/earcut/earcut ../2d/engine/webgl/Geometry ./Bucket".split(" "),function(q,a,b,p,m,f,l,c){return function(a){function c(d,
c,e,h,l,n){c=a.call(this,d,c)||this;if(d.hasDataDrivenFill!==e.isDataDriven())throw Error("incompatible fill buffer");if(d.hasDataDrivenOutline!==l.isDataDriven())throw Error("incompatible outline buffer");c._fillVertexBuffer=e;c._fillIndexBuffer=h;c._outlineVertexBuffer=l;c._outlineIndexBuffer=n;return c}b(c,a);Object.defineProperty(c.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"outlineIndexStart",{get:function(){return this._outlineIndexStart},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!0,configurable:!0});c.prototype.assignBufferInfo=function(a){a._fillIndexStart=this._fillIndexStart;a._fillIndexCount=this._fillIndexCount;a.layer.getPaintProperty("fill-outline-color")?(a._outlineIndexStart=this._outlineIndexStart,
a._outlineIndexCount=this._outlineIndexCount):(a._outlineIndexStart=0,a._outlineIndexCount=0)};c.prototype.processFeatures=function(a,c){this._fillIndexStart=this._fillIndexBuffer.index;this._fillIndexCount=0;this._outlineIndexStart=this._outlineIndexBuffer.index;this._outlineIndexCount=0;c=this.layer;var d=this.zoom,e=c.hasDataDrivenFill,h=c.hasDataDrivenOutline;a&&a.setExtent(this.layerExtent);var n=c.getPaintValue("fill-pattern",d),l=c.getPaintValue("fill-antialias",d)&&void 0===n,r=[1,1,1,1],
b=[1,1,1,1],m=1;if(c.outlineUsesFillColor){if(l&&!c.hasDataDrivenOpacity){var f=c.getPaintValue("fill-opacity",d),v=c.getPaintValue("fill-opacity",d+1);1>f&&1>v&&(l=!1)}l&&!c.hasDataDrivenColor&&(f=c.getPaintValue("fill-color",d),v=c.getPaintValue("fill-color",d+1),1>f[3]&&1>v[3]&&(l=!1))}f=0;for(v=this._features;f<v.length;f++){var p=v[f];!n&&c.hasDataDrivenColor&&(r=c.getPaintValue("fill-color",d,p));c.hasDataDrivenOpacity&&(m=c.getPaintValue("fill-opacity",d,p));!n&&c.hasDataDrivenOutlineColor&&
(b=c.getPaintValue("fill-outline-color",d,p));var E=void 0;e&&(E={color:r,opacity:m});var H=void 0;h&&(H={color:c.outlineUsesFillColor?r:b,opacity:m});p=p.getGeometry(a);this._processFeature(p,l,c.outlineUsesFillColor,E,H)}};c.prototype._processFeature=function(a,e,h,l,b){if(a){var d=a.length;if(e&&(!h||!b||1===b.color[3]*b.opacity))for(e=0;e<d;e++)this._processOutline(a[e],b);var m;for(e=0;e<d;e++)b=c._area(a[e]),128<b?(void 0!==m&&this._processFill(a,m,l),m=[e]):-128>b&&void 0!==m&&m.push(e);void 0!==
m&&this._processFill(a,m,l)}};c.prototype._processOutline=function(a,c){var d=this._outlineVertexBuffer,e=this._outlineIndexBuffer,h=e.index,n,b,m,r=new l.Point(0,0),f=new l.Point(0,0),p=new l.Point(0,0),v=-1,u=-1,E=-1,H=-1,P=-1,O=!1,Q=a.length;if(!(2>Q)){var R=a[0];for(n=a[Q-1];Q&&n.isEqual(R);)--Q,n=a[Q-1];if(!(2>Q-0)){for(R=0;R<Q;++R){0===R?(n=a[Q-1],b=a[0],m=a[1],r.assignSub(b,n),r.normalize(),r.rightPerpendicular()):(n=b,b=m,m=R!==Q-1?a[R+1]:a[0],r.assign(f));n=this._isClipEdge(n,b);-1===H&&
(O=n);f.assignSub(m,b);f.normalize();f.rightPerpendicular();E=r.x*f.y-r.y*f.x;p.assignAdd(r,f);p.normalize();var L=-p.x*-r.x+-p.y*-r.y,L=Math.abs(0!==L?1/L:1);8<L&&(L=8);0<=E?(E=d.add(b.x,b.y,r.x,r.y,0,1,c),-1===H&&(H=E),0<=v&&0<=u&&0<=E&&!n&&e.add(v,u,E),u=d.add(b.x,b.y,L*-p.x,L*-p.y,0,-1,c),-1===P&&(P=u),0<=v&&0<=u&&0<=E&&!n&&e.add(v,u,E),v=u,u=E,E=d.add(b.x,b.y,p.x,p.y,0,1,c),0<=v&&0<=u&&0<=E&&!n&&e.add(v,u,E),u=d.add(b.x,b.y,f.x,f.y,0,1,c)):(E=d.add(b.x,b.y,L*p.x,L*p.y,0,1,c),-1===H&&(H=E),0<=
v&&0<=u&&0<=E&&!n&&e.add(v,u,E),u=d.add(b.x,b.y,-r.x,-r.y,0,-1,c),-1===P&&(P=u),0<=v&&0<=u&&0<=E&&!n&&e.add(v,u,E),v=u,u=E,E=d.add(b.x,b.y,-p.x,-p.y,0,-1,c),0<=v&&0<=u&&0<=E&&!n&&e.add(v,u,E),v=d.add(b.x,b.y,-f.x,-f.y,0,-1,c));0<=v&&0<=u&&0<=E&&!n&&e.add(v,u,E)}0<=v&&0<=u&&0<=H&&!O&&e.add(v,u,H);0<=v&&0<=H&&0<=P&&!O&&e.add(v,P,H);this._outlineIndexCount+=3*(e.index-h)}}};c.prototype._processFill=function(a,c,e){var d;1<c.length&&(d=[]);for(var h=0,b=0;b<c.length;b++){var l=c[b];0!==h&&d.push(h);h+=
a[l].length}for(var b=2*h,h=m.acquire(),r=0;r<c.length;r++)for(var l=c[r],l=a[l],p=l.length,z=0;z<p;++z)h.push(l[z].x),h.push(l[z].y);a=f(h,d,2);c=a.length;if(0<c){d=this._fillVertexBuffer.index;for(r=0;r<b;)this._fillVertexBuffer.add(h[r++],h[r++],e);for(e=0;e<c;)this._fillIndexBuffer.add(d+a[e++],d+a[e++],d+a[e++]);this._fillIndexCount+=c}m.release(h)};c.prototype._isClipEdge=function(a,c){return a.x===c.x?-64>=a.x||4160<=a.x:a.y===c.y?-64>=a.y||4160<=a.y:!1};c._area=function(a){for(var c=0,d=a.length-
1,e=0;e<d;e++)c+=(a[e].x-a[e+1].x)*(a[e].y+a[e+1].y);c+=(a[d].x-a[0].x)*(a[d].y+a[0].y);return.5*c};return c}(c)})},"esri/core/ArrayPool":function(){define(["require","exports","./ObjectPool"],function(q,a,b){function p(a){a.length=0}var m=Array.prototype.splice;q=function(){function a(a,e){void 0===a&&(a=50);void 0===e&&(e=50);this._pool=new b(Array,!1,p,e,a)}a.prototype.acquire=function(){return this._pool.acquire()};a.prototype.copy=function(a){var c=this.acquire();a.unshift(0,0);m.apply(c,a);
a.splice(0,2);return c};a.prototype.release=function(a){this._pool.release(a)};a.acquire=function(){return f.acquire()};a.copy=function(a){return f.copy(a)};a.release=function(a){return f.release(a)};return a}();var f=new q(100);return q})},"esri/core/libs/earcut/earcut":function(){define([],function(){function q(c,d,h){h=h||2;C=c.length/h+(d?2*d.length:0);y=!1;var n=d&&d.length,m=n?d[0]*h:c.length,r=a(c,0,m,h,!0),v=[];if(!r)return v;var z,A,u,x;if(n)a:{var w=h,n=[],I,F,J;x=0;for(I=d.length;x<I;x++)F=
d[x]*w,J=x<I-1?d[x+1]*w:c.length,F=a(c,F,J,w,!1),F===F.next&&(F.steiner=!0),n.push(e(F));n.sort(f);for(x=0;x<n.length;x++){if(!r){r=null;break a}d=n[x];w=r;if(w=l(d,w))d=D(w,d),b(d,d.next);r=b(r,r.next)}}if(y)return v;if(c.length>80*h){z=u=c[0];A=n=c[1];for(w=h;w<m;w+=h)x=c[w],d=c[w+1],x<z&&(z=x),d<A&&(A=d),x>u&&(u=x),d>n&&(n=d);u=Math.max(u-z,n-A)}p(r,v,h,z,A,u);return v}function a(a,c,d,e,h){var b;if(h===0<B(a,c,d,e))for(h=c;h<d;h+=e)b=n(h,a[h],a[h+1],b);else for(h=d-e;h>=c;h-=e)b=n(h,a[h],a[h+
1],b);b&&r(b,b.next)&&(x(b),b=b.next);return b}function b(a,c){if(!a)return a;c||(c=a);var e,h=0,b=C*C/2;do{e=!1;if(a.steiner||!r(a,a.next)&&0!==d(a.prev,a,a.next))a=a.next;else{x(a);a=c=a.prev;if(a===a.next)return null;e=!0}if(h++>b)return y=!0,null}while(e||a!==c);return c}function p(a,e,n,l,f,J,C){if(a){if(!C&&J){var v=a,u=v;do null===u.z&&(u.z=c(u.x,u.y,l,f,J)),u.prevZ=u.prev,u=u.nextZ=u.next;while(u!==v);u.prevZ.nextZ=null;u.prevZ=null;var v=u,E,G,w,I,F,B,H=1;do{u=v;w=v=null;for(I=0;u;){I++;
G=u;for(E=F=0;E<H&&(F++,G=G.nextZ,G);E++);for(B=H;0<F||0<B&&G;)0===F?(E=G,G=G.nextZ,B--):0!==B&&G?u.z<=G.z?(E=u,u=u.nextZ,F--):(E=G,G=G.nextZ,B--):(E=u,u=u.nextZ,F--),w?w.nextZ=E:v=E,E.prevZ=w,w=E;u=G}w.nextZ=null;H*=2}while(1<I)}for(v=a;a.prev!==a.next;){u=a.prev;G=a.next;if(J)a:{w=a;B=l;var K=f,V=J;I=w.prev;F=w;H=w.next;if(0<=d(I,F,H))w=!1;else{var P=I.x>F.x?I.x>H.x?I.x:H.x:F.x>H.x?F.x:H.x,O=I.y>F.y?I.y>H.y?I.y:H.y:F.y>H.y?F.y:H.y;E=c(I.x<F.x?I.x<H.x?I.x:H.x:F.x<H.x?F.x:H.x,I.y<F.y?I.y<H.y?I.y:
H.y:F.y<H.y?F.y:H.y,B,K,V);B=c(P,O,B,K,V);for(K=w.nextZ;K&&K.z<=B;){if(K!==w.prev&&K!==w.next&&h(I.x,I.y,F.x,F.y,H.x,H.y,K.x,K.y)&&0<=d(K.prev,K,K.next)){w=!1;break a}K=K.nextZ}for(K=w.prevZ;K&&K.z>=E;){if(K!==w.prev&&K!==w.next&&h(I.x,I.y,F.x,F.y,H.x,H.y,K.x,K.y)&&0<=d(K.prev,K,K.next)){w=!1;break a}K=K.prevZ}w=!0}}else w=m(a);if(w)e.push(u.i/n),e.push(a.i/n),e.push(G.i/n),x(a),v=a=G.next;else{if(y)break;a=G;if(a===v){if(!C)p(b(a),e,n,l,f,J,1);else if(1===C){C=e;v=n;u=a;do G=u.prev,w=u.next.next,
!r(G,w)&&z(G,u,u.next,w)&&A(G,w)&&A(w,G)&&(C.push(G.i/v),C.push(u.i/v),C.push(w.i/v),x(u),x(u.next),u=a=w),u=u.next;while(u!==a);a=u;p(a,e,n,l,f,J,2)}else if(2===C)a:{C=a;do{for(v=C.next.next;v!==C.prev;){if(u=C.i!==v.i){u=C;G=v;w=void 0;if(w=u.next.i!==G.i&&u.prev.i!==G.i){w=void 0;b:{w=u;do{if(w.i!==u.i&&w.next.i!==u.i&&w.i!==G.i&&w.next.i!==G.i&&z(w,w.next,u,G)){w=!0;break b}w=w.next}while(w!==u);w=!1}w=!w}I=void 0;if(I=w&&A(u,G)&&A(G,u)){w=u;I=!1;F=(u.x+G.x)/2;G=(u.y+G.y)/2;do w.y>G!==w.next.y>
G&&F<(w.next.x-w.x)*(G-w.y)/(w.next.y-w.y)+w.x&&(I=!I),w=w.next;while(w!==u)}u=I}if(u){a=D(C,v);C=b(C,C.next);a=b(a,a.next);p(C,e,n,l,f,J);p(a,e,n,l,f,J);break a}v=v.next}C=C.next}while(C!==a)}break}}}}}function m(a){var c=a.prev,e=a.next;if(0<=d(c,a,e))return!1;for(var b=a.next.next,n=0;b!==a.prev;){if(h(c.x,c.y,a.x,a.y,e.x,e.y,b.x,b.y)&&0<=d(b.prev,b,b.next))return!1;b=b.next;if(n++>C)return y=!0,!1}return!0}function f(a,c){return a.x-c.x}function l(a,c){var d=c,e=a.x,b=a.y,n=-Infinity,l;do{if(!d)return null;
if(b<=d.y&&b>=d.next.y){var m=d.x+(b-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(m<=e&&m>n){n=m;if(m===e){if(b===d.y)return d;if(b===d.next.y)return d.next}l=d.x<d.next.x?d:d.next}}d=d.next}while(d!==c);if(!l)return null;if(e===n)return l.prev;c=l;for(var m=l.x,r=l.y,f=Infinity,p,d=l.next;d!==c;)e>=d.x&&d.x>=m&&h(b<r?e:n,b,m,r,b<r?n:e,b,d.x,d.y)&&(p=Math.abs(b-d.y)/(e-d.x),(p<f||p===f&&d.x>l.x)&&A(d,a)&&(l=d,f=p)),d=d.next;return l}function c(a,c,d,e,h){a=32767*(a-d)/h;c=32767*(c-e)/h;a=(a|a<<8)&16711935;
a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1}function e(a){var c=a,d=a;do c.x<d.x&&(d=c),c=c.next;while(c!==a);return d}function h(a,c,d,e,h,b,n,l){return 0<=(h-n)*(c-l)-(a-n)*(b-l)&&0<=(a-n)*(e-l)-(d-n)*(c-l)&&0<=(d-n)*(b-l)-(h-n)*(e-l)}function d(a,c,d){return(c.y-a.y)*(d.x-c.x)-(c.x-a.x)*(d.y-c.y)}function r(a,c){return a.x===c.x&&a.y===c.y}function z(a,c,e,h){return r(a,c)&&r(e,h)||r(a,
h)&&r(e,c)?!0:0<d(a,c,e)!==0<d(a,c,h)&&0<d(e,h,a)!==0<d(e,h,c)}function A(a,c){return 0>d(a.prev,a,a.next)?0<=d(a,c,a.next)&&0<=d(a,a.prev,c):0>d(a,c,a.prev)||0>d(a,a.next,c)}function D(a,c){var d=new J(a.i,a.x,a.y),e=new J(c.i,c.x,c.y),h=a.next,b=c.prev;a.next=c;c.prev=a;d.next=h;h.prev=d;e.next=d;d.prev=e;b.next=e;e.prev=b;return e}function n(a,c,d,e){a=new J(a,c,d);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a}function x(a){a.next.prev=a.prev;a.prev.next=a.next;
a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function J(a,c,d){this.i=a;this.x=c;this.y=d;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function B(a,c,d,e){for(var h=0,b=d-e;c<d;c+=e)h+=(a[b]-a[c])*(a[c+1]+a[b+1]),b=c;return h}var C,y;q.deviation=function(a,c,d,e){var h=c&&c.length,b=Math.abs(B(a,0,h?c[0]*d:a.length,d));if(h)for(var h=0,n=c.length;h<n;h++)b-=Math.abs(B(a,c[h]*d,h<n-1?c[h+1]*d:a.length,d));for(h=c=0;h<e.length;h+=3){var n=e[h]*d,l=e[h+1]*
d,m=e[h+2]*d;c+=Math.abs((a[n]-a[m])*(a[l+1]-a[n+1])-(a[n]-a[l])*(a[m+1]-a[n+1]))}return 0===b&&0===c?0:Math.abs((c-b)/b)};q.flatten=function(a){for(var c=a[0][0].length,d={vertices:[],holes:[],dimensions:c},e=0,h=0;h<a.length;h++){for(var b=0;b<a[h].length;b++)for(var n=0;n<c;n++)d.vertices.push(a[h][b][n]);0<h&&(e+=a[h-1].length,d.holes.push(e))}return d};return q})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(q,a){Object.defineProperty(a,"__esModule",
{value:!0});q=function(){function a(a,b){this.x=a;this.y=b}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.equals=function(a,b){return a===this.x&&b===this.y};a.prototype.isEqual=function(a){return a.x===this.x&&a.y===this.y};a.prototype.setCoords=function(a,b){this.x=a;this.y=b};a.prototype.normalize=function(){var a=this.x,b=this.y,a=Math.sqrt(a*a+b*b);this.x/=a;this.y/=a};a.prototype.rightPerpendicular=function(){var a=this.x;this.x=this.y;this.y=-a};a.prototype.move=function(a,
b){this.x+=a;this.y+=b};a.prototype.assign=function(a){this.x=a.x;this.y=a.y};a.prototype.assignAdd=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y};a.prototype.assignSub=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y};a.prototype.rotate=function(a,b){var m=this.x,l=this.y;this.x=m*a-l*b;this.y=m*b+l*a};a.prototype.scale=function(a){this.x*=a;this.y*=a};a.prototype.length=function(){var a=this.x,b=this.y;return Math.sqrt(a*a+b*b)};a.distance=function(a,b){var m=b.x-a.x;a=b.y-a.y;return Math.sqrt(m*m+a*a)};
a.add=function(b,m){return new a(b.x+m.x,b.y+m.y)};a.sub=function(b,m){return new a(b.x-m.x,b.y-m.y)};return a}();a.Point=q})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(q,a){function b(a,b){a%=b;return 0<=a?a:a+b}Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=
1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var p=1/Math.LN2;a.positiveMod=b;a.radToByte=function(m){return b(m*a.C_RAD_TO_256,256)};a.degToByte=function(m){return b(m*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*p};a.sqr=function(a){return a*a};a.clamp=function(a,b,l){return Math.min(Math.max(a,b),l)};a.interpolate=function(a,b,l){return a*(1-l)+b*l};a.between=function(a,b,l){return a>=b&&a<=l||a>=l&&a<=b}})},"esri/views/vectorTiles/IndexMemoryBuffer":function(){define(["require","exports",
"../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./MemoryBuffer"],function(q,a,b,p,m){Object.defineProperty(a,"__esModule",{value:!0});q=function(a){function l(){return a.call(this,12)||this}b(l,a);l.prototype.add=function(a,e,h){var c=this.array;c.push(a);c.push(e);c.push(h)};return l}(m);a.TriangleIndexBuffer=q;m=function(a){function l(){return a.call(this,4)||this}b(l,a);l.prototype.add=function(a){this.array.push(a)};return l}(m);a.PointElementMemoryBuffer=m})},"esri/views/vectorTiles/MemoryBuffer":function(){define(["require",
"exports"],function(q,a){return function(){function a(a){this._array=[];0>=a&&console.error("strideInBytes must be positive!");this._stride=a}Object.defineProperty(a.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!0,configurable:!0});a.prototype.reset=function(){this.array.length=0};a.prototype.toBuffer=function(){return(new Uint32Array(this._array)).buffer};a.i1616to32=function(a,b){return 65535&a|b<<16};a.i8888to32=function(a,b,f,l){return a&255|(b&255)<<8|(f&255)<<16|l<<24};a.i8816to32=function(a,b,f){return a&255|(b&255)<<8|f<<16};return a}()})},"esri/views/vectorTiles/LineBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../2d/engine/webgl/LineTess ./Bucket ./style/StyleLayer".split(" "),
function(q,a,b,p,m,f,l){var c=new m.Tessellator({distanceAlongCorrection:!0});return function(a){function e(c,e,h,b){e=a.call(this,c,e)||this;e.extrudeVectorsDoubleBuffer=[m.allocExtrudeVectors(),m.allocExtrudeVectors()];e.firstExtrudeVectors=m.allocExtrudeVectors();e.recycledTriangleBridge=m.allocTriangles(20);e.recycledTrianglePie=m.allocTriangles(20);if(c.hasDataDrivenLine!==h.isDataDriven())throw Error("incompatible line buffer");e._lineVertexBuffer=h;e._lineIndexBuffer=b;return e}b(e,a);Object.defineProperty(e.prototype,
"lineIndexStart",{get:function(){return this._lineIndexStart},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!0,configurable:!0});e.prototype.assignBufferInfo=function(a){a._lineIndexStart=this._lineIndexStart;a._lineIndexCount=this._lineIndexCount};e.prototype.processFeatures=function(a,c){this._lineIndexStart=this._lineIndexBuffer.index;this._lineIndexCount=0;c=this.layer;var d=this.zoom,e=c.hasDataDrivenLine;
a&&a.setExtent(this.layerExtent);for(var h=c.getPaintValue("line-pattern",d),b=[1,1,1,1],r=1,m=1,f=0,p=this._features;f<p.length;f++){var y=p[f],v=new l.LineLayout(c,d,y);!h&&c.hasDataDrivenColor&&(b=c.getPaintValue("line-color",d,y));c.hasDataDrivenOpacity&&(r=c.getPaintValue("line-opacity",d,y));c.hasDataDrivenWidth&&(m=c.getPaintValue("line-width",d,y));var u=void 0;if(e&&(u={color:b,opacity:r,size:Math.max(Math.min(m,256),0)},0>=u.size||0>=u.opacity||0>=u.color[3]))continue;y=y.getGeometry(a);
this._processFeature(v,y,u)}};e.prototype._processFeature=function(a,c,e){if(c)for(var d=c.length,h=0;h<d;h++)this._processGeometry(c[h],a,e)};e.prototype._processGeometry=function(a,c,e){if(!(2>a.length)){for(var d=a[0],h=a[a.length-1],b=h.x-d.x,h=h.y-d.y,d=1E-6>b*b+h*h,l=a[0],f=1;f<a.length;)b=a[f].x-l.x,h=a[f].y-l.y,1E-6>b*b+h*h?a.splice(f,1):(l=a[f],++f);if(!(2>a.length)){this.vertices=a;this.verticesLen=a.length;this.isClosed=d;this.cap=c.cap;this.join=c.join;this.almostParallelRads=.05;this.veryShallowRads=
.1;this.miterSafeRads=m.MITER_SAFE_RADS;this.miterLimitMag=Math.min(c.miterLimit,m.SYSTEM_MAG_LIMIT);this.roundLimitRads=Math.min(c.roundLimit,.5);this.newRoundJoinsSafeRads=2.3;c=this._lineIndexBuffer.index;for(var b=0,r=void 0,h=this.verticesLen,l=0;l<h;++l){var f=a[l],z=a[(l+h-1)%h],p=d&&this._isClipEdge(z,f),z=r===this.extrudeVectorsDoubleBuffer[l%2]?this.extrudeVectorsDoubleBuffer[(l+1)%2]:this.extrudeVectorsDoubleBuffer[l%2];l<h-1||!d||this.hasPattern?(this._computeExtrudeVectors(z,l),this._writeGPUVertices(f.x,
f.y,b,z,e),!z.capCenter||d&&l===h-1||this._writeGPUPieElements(z,p),d&&0===l&&!this.hasPattern&&m.copyExtrudeVectors(this.firstExtrudeVectors,z)):m.copyExtrudeVectors(z,this.firstExtrudeVectors);r&&this._writeGPUBridgeElements(r,z,p);l<h-1&&(r=a[l+1],f=m.length([r.x-f.x,r.y-f.y]),b+=f);r=z}this._lineIndexCount+=3*(this._lineIndexBuffer.index-c)}}};e.prototype._computeExtrudeVectors=function(a,c){var d=this.vertices,e=this.verticesLen,h=this.isClosed,b=d[c],l=[void 0,void 0],f=[void 0,void 0];if(0<
c&&c<e-1){var r=d[(c+e-1)%e],p=d[(c+1)%e];m.normalize(l,[b.x-r.x,b.y-r.y]);m.normalize(f,[p.x-b.x,p.y-b.y])}else if(0===c)p=d[(c+1)%e],m.normalize(f,[p.x-b.x,p.y-b.y]),h?(d=d[e-2],m.normalize(l,[b.x-d.x,b.y-d.y])):l=f;else if(c===e-1)r=d[(c+e-1)%e],m.normalize(l,[b.x-r.x,b.y-r.y]),h?(d=d[1],m.normalize(f,[d.x-b.x,d.y-b.y])):f=l;else{console.error("Vertex index 'i' out of range.");return}h||0!==c?h||c!==e-1?this._computeJoinExtrudeVectors(a,l,f):this._computeCapExtrudeVectors(a,l,f,m.CapPosition.END):
this._computeCapExtrudeVectors(a,l,f,m.CapPosition.START)};e.prototype._computeCapExtrudeVectors=function(a,e,h,b){0===this.cap?c.buttCap(a,e,h):1===this.cap?c.roundCap(a,e,h,b,m.getNumberOfSlices(Math.PI),b===m.CapPosition.START?-1:1):2===this.cap?c.squareCap(a,e,h,b):c.buttCap(a,e,h)};e.prototype._computeJoinExtrudeVectors=function(a,e,h){var d=m.getRads(e,h);if(d>Math.PI-this.almostParallelRads)c.rectJoin(a,e,h);else if(0===this.join&&d>=this.veryShallowRads)c.bevelJoin(a,e,h,1);else if(1===this.join&&
d>=this.veryShallowRads){var b=m.getNumberOfSlices(d);d<this.newRoundJoinsSafeRads?2>b||d<this.roundLimitRads?c.bevelJoin(a,e,h,1):c.roundJoin(a,e,h,b):c.unitRoundJoin(a,e,h,b)}else d<this.almostParallelRads?c.fastMiterJoin(a,e,h):d<this.miterSafeRads?c.miterJoin(a,e,h):c.bevelJoin(a,e,h,this.miterLimitMag)};e.prototype._writeGPUVertices=function(a,c,e,h,b){for(var d=0;d<h.vectors.count;++d){var l=h.vectors.items[d].vector[0],f=h.vectors.items[d].vector[1],m=h.vectors.items[d].texCoords[0],r=h.vectors.items[d].texCoords[1];
h.vectors.items[d].base=this._lineVertexBuffer.index;this._lineVertexBuffer.add(a,c,l,f,m,r,e,b)}};e.prototype._writeGPUBridgeElements=function(a,e,h){c.bridge(this.recycledTriangleBridge,a,e);if(!h)for(a=0;a<this.recycledTriangleBridge.count;++a)e=this.recycledTriangleBridge.items[a],this._lineIndexBuffer.add(e.v1.base,e.v2.base,e.v3.base)};e.prototype._writeGPUPieElements=function(a,e){c.pie(this.recycledTrianglePie,a);if(!e)for(a=0;a<this.recycledTrianglePie.count;++a)e=this.recycledTrianglePie.items[a],
this._lineIndexBuffer.add(e.v1.base,e.v2.base,e.v3.base)};e.prototype._isClipEdge=function(a,c){return a.x===c.x?-64>=a.x||4160<=a.x:a.y===c.y?-64>=a.y||4160<=a.y:!1};return e}(f)})},"esri/views/2d/engine/webgl/LineTess":function(){define(["require","exports"],function(q,a){function b(a){var c={items:[],count:0},d;for(d=0;d<a;++d)c.items.push(void 0);return c}function p(a,c){C.vector[0]=a.vector[0];C.vector[1]=a.vector[1];C.texCoords[0]=a.texCoords[0];C.texCoords[1]=a.texCoords[1];C.direction[0]=
a.direction[0];C.direction[1]=a.direction[1];C.base=a.base;a.vector[0]=c.vector[0];a.vector[1]=c.vector[1];a.texCoords[0]=c.texCoords[0];a.texCoords[1]=c.texCoords[1];a.direction[0]=c.direction[0];a.direction[1]=c.direction[1];a.base=c.base;c.vector[0]=C.vector[0];c.vector[1]=C.vector[1];c.texCoords[0]=C.texCoords[0];c.texCoords[1]=C.texCoords[1];c.direction[0]=C.direction[0];c.direction[1]=C.direction[1];c.base=C.base}function m(a,c){return a[0]*c[0]+a[1]*c[1]}function f(a){return Math.sqrt(m(a,
a))}function l(a,c){var d=f(c);a[0]=c[0]/d;a[1]=c[1]/d;return a}function c(a,c){a[0]=-c[1];a[1]=c[0];return a}function e(a,c){return a[0]*c[1]-a[1]*c[0]}function h(a,c){a[0]=-c[0];a[1]=-c[1];return a}function d(a,c,d){a[0]=c[0]*d;a[1]=c[1]*d;return a}function r(a,c,d){a[0]=c[0]+d[0];a[1]=c[1]+d[1];return a}function z(a,c){a=m(a,c);return.999<a?0:-.999>a?Math.PI:Math.acos(a)}function A(a,c,e,h,b){if(0===h)a.count=0;else{var l=f(c),n=d(y[0],c,1/l);e=d(y[1],e,1/l);n=z(n,e);n=(b?-1:1)*n/h;b=Math.cos(n);
n=Math.sin(n);e=c[0];var m=c[1];for(c=0;c<h-1;++c)l=e,e=b*l-n*m,m=n*l+b*m,a.items[c][0]=e,a.items[c][1]=m;a.count=h-1}}function D(a){var c=a.count,d=Math.floor(c/2),e;for(e=0;e<d;++e){var h=a.items[e];a.items[e]=a.items[c-e-1];a.items[c-e-1]=h}}Object.defineProperty(a,"__esModule",{value:!0});var n;(function(a){a[a.ENTRY=1]="ENTRY";a[a.EXIT=2]="EXIT";a[a.CAP=3]="CAP"})(n=a.VectorRole||(a.VectorRole={}));var x;(function(a){a[a.START=1]="START";a[a.END=2]="END"})(x=a.CapPosition||(a.CapPosition={}));
a.SYSTEM_MAG_LIMIT=3.8;a.MITER_SAFE_RADS=2*Math.acos(1/a.SYSTEM_MAG_LIMIT);var J=a.SYSTEM_MAG_LIMIT*a.SYSTEM_MAG_LIMIT,B=16/(2*Math.PI);a.allocTriangles=function(a){var c={items:[],count:0},d;for(d=0;d<a;++d)c.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return c};a.allocExtrudeVectors=function(){var a=
{items:[],count:0},c;for(c=0;30>c;++c)a.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});c={};c[n.ENTRY]=b(20);c[n.EXIT]=b(20);c[n.CAP]=b(20);return{vectors:a,lists:c}};a.copyExtrudeVectors=function(a,c){var d;for(d=0;d<c.vectors.count;++d)a.vectors.items[d].vector[0]=c.vectors.items[d].vector[0],a.vectors.items[d].vector[1]=c.vectors.items[d].vector[1],a.vectors.items[d].texCoords[0]=c.vectors.items[d].texCoords[0],a.vectors.items[d].texCoords[1]=c.vectors.items[d].texCoords[1],
a.vectors.items[d].direction[0]=c.vectors.items[d].direction[0],a.vectors.items[d].direction[1]=c.vectors.items[d].direction[1],a.vectors.items[d].base=c.vectors.items[d].base;a.vectors.count=c.vectors.count;var e=c.lists[n.ENTRY],h=a.lists[n.ENTRY],b=c.lists[n.EXIT],l=a.lists[n.EXIT],f=c.lists[n.CAP],m=a.lists[n.CAP];for(d=0;d<e.count;++d)h.items[d]=e.items[d];h.count=e.count;for(d=0;d<b.count;++d)l.items[d]=b.items[d];l.count=b.count;for(d=0;d<f.count;++d)m.items[d]=f.items[d];m.count=f.count;a.capCenter=
c.capCenter};var C={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};a.swapExtrudeVectors=p;var y=[];for(q=0;32>q;++q)y.push([void 0,void 0]);var v=function(a){var c={items:[],count:0},d;for(d=0;d<a;++d)c.items.push([void 0,void 0]);return c}(16);a.length=f;a.normalize=l;a.getNumberOfSlices=function(a){return Math.max(Math.round(a*B),1)};a.getRads=z;a.reverse=D;var u=[void 0,void 0],E=[void 0,void 0],H=[0,0],P=[0,0],O=[0,0],Q=[0,0],R=Math.cos(Math.PI/4),L=Math.sin(Math.PI/
4),S=Math.sqrt(2);q=function(){function a(a){this._distanceAlongCorrection=a.distanceAlongCorrection}a.prototype.bridge=function(a,c,d){var e=c.vectors;c=c.lists[n.EXIT];var h=d.vectors,b=d.lists[n.ENTRY],l,f;if(c.count===b.count+1)d=c.items,l=e.items,f=b.items,h=h.items;else if(b.count===c.count+1)d=b.items,l=h.items,f=c.items,h=e.items;else if(c.count===b.count)d=b.items,l=h.items,f=c.items,h=e.items;else{console.error("Cannot bridge "+c.count+" to "+b.count+".");a.count=0;return}e=c.count+b.count-
2;a.count=e;u[0]=d;u[1]=f;E[0]=l;E[1]=h;for(c=0;c<e;++c)d=a.items[c],l=(c+0)%2,l=E[l][u[l][Math.floor((c+0)/2)]],d.v1.vector[0]=l.vector[0],d.v1.vector[1]=l.vector[1],d.v1.texCoords[0]=l.texCoords[0],d.v1.texCoords[1]=l.texCoords[1],d.v1.direction[0]=l.direction[0],d.v1.direction[1]=l.direction[1],d.v1.base=l.base,l=(c+1)%2,l=E[l][u[l][Math.floor((c+1)/2)]],d.v2.vector[0]=l.vector[0],d.v2.vector[1]=l.vector[1],d.v2.texCoords[0]=l.texCoords[0],d.v2.texCoords[1]=l.texCoords[1],d.v2.direction[0]=l.direction[0],
d.v2.direction[1]=l.direction[1],d.v2.base=l.base,l=(c+2)%2,l=E[l][u[l][Math.floor((c+2)/2)]],d.v3.vector[0]=l.vector[0],d.v3.vector[1]=l.vector[1],d.v3.texCoords[0]=l.texCoords[0],d.v3.texCoords[1]=l.texCoords[1],d.v3.direction[0]=l.direction[0],d.v3.direction[1]=l.direction[1],d.v3.base=l.base,l=d.v1.base&&d.v1.base.point||H,f=d.v2.base&&d.v2.base.point||H,h=d.v3.base&&d.v3.base.point||H,P[0]=l[0]+d.v1.vector[0],P[1]=l[1]+d.v1.vector[1],O[0]=f[0]+d.v2.vector[0],O[1]=f[1]+d.v2.vector[1],Q[0]=h[0]+
d.v3.vector[0],Q[1]=h[1]+d.v3.vector[1],0>(O[0]-P[0])*(Q[1]-P[1])-(Q[0]-P[0])*(O[1]-P[1])||p(d.v2,d.v3)};a.prototype.pie=function(a,c){if(0===c.lists[n.CAP].count)a.count=0;else if(1===c.lists[n.CAP].count)console.error("A single vector is not enough to define a pie."),a.count=0;else{a.count=c.lists[n.CAP].count-1;var d;for(d=0;d<a.count;++d){var e=a.items[d],h=c.vectors.items[c.lists[n.CAP].items[d]];e.v1.vector[0]=h.vector[0];e.v1.vector[1]=h.vector[1];e.v1.texCoords[0]=h.texCoords[0];e.v1.texCoords[1]=
h.texCoords[1];e.v1.direction[0]=h.direction[0];e.v1.direction[1]=h.direction[1];e.v1.base=h.base;h=c.vectors.items[c.lists[n.CAP].items[d+1]];e.v2.vector[0]=h.vector[0];e.v2.vector[1]=h.vector[1];e.v2.texCoords[0]=h.texCoords[0];e.v2.texCoords[1]=h.texCoords[1];e.v2.direction[0]=h.direction[0];e.v2.direction[1]=h.direction[1];e.v2.base=h.base;h=c.vectors.items[c.capCenter];e.v3.vector[0]=h.vector[0];e.v3.vector[1]=h.vector[1];e.v3.texCoords[0]=h.texCoords[0];e.v3.texCoords[1]=h.texCoords[1];e.v3.direction[0]=
h.direction[0];e.v3.direction[1]=h.direction[1];e.v3.base=h.base;var h=e.v1.base&&e.v1.base.point||H,b=e.v2.base&&e.v2.base.point||H,l=e.v3.base&&e.v3.base.point||H;P[0]=h[0]+e.v1.vector[0];P[1]=h[1]+e.v1.vector[1];O[0]=b[0]+e.v2.vector[0];O[1]=b[1]+e.v2.vector[1];Q[0]=l[0]+e.v3.vector[0];Q[1]=l[1]+e.v3.vector[1];0>(O[0]-P[0])*(Q[1]-P[1])-(Q[0]-P[0])*(O[1]-P[1])||p(e.v2,e.v3)}}};a.prototype.buttCap=function(a,c,d){this.fastMiterJoin(a,c,d)};a.prototype.roundCap=function(a,c,d,e,h,b){void 0===b&&(b=
0);this.fastMiterJoin(a,c,d);d=e===x.START?0:1;e=e===x.START?1:0;a.capCenter=a.vectors.count;c=a.vectors.items[a.capCenter];c.vector[0]=0;c.vector[1]=0;c.texCoords[0]=0;c.texCoords[1]=0;c.direction[0]=0;c.direction[1]=0;++a.vectors.count;A(v,a.vectors.items[d].vector,a.vectors.items[e].vector,h,!1);h=a.vectors.count;c=a.lists[n.CAP];c.items[0]=d;d=a.vectors.items[d].texCoords[1];var l=a.vectors.items[e].texCoords[1],f;for(f=0;f<v.count;++f){var m=b*(1-Math.abs(v.count/2-f)/(v.count/2)),r=d+f/(v.count-
1)*(l-d),p=v.items[f],y=a.vectors.items[h+f];y.vector[0]=p[0];y.vector[1]=p[1];y.texCoords[0]=m;y.texCoords[1]=r;y.direction[0]=0;y.direction[1]=0;c.items[f+1]=h+f}c.items[v.count+1]=e;c.count=v.count+2;a.vectors.count=h+v.count};a.prototype.squareCap=function(a,c,e,h){this.fastMiterJoin(a,c,e);c=h===x.START?0:1;e=h===x.START?1:0;var b=y[0],l=y[1],n=y[2],f=y[3];h=y[4];var m=a.vectors.items[c].vector;b[0]=R*m[0]-L*m[1];b[1]=L*m[0]+R*m[1];d(f,b,S);l[0]=R*b[0]-L*b[1];l[1]=L*b[0]+R*b[1];n[0]=R*l[0]-L*
l[1];n[1]=L*l[0]+R*l[1];d(h,n,S);c=a.vectors.items[c];c.vector[0]=f[0];c.vector[1]=f[1];a=a.vectors.items[e];a.vector[0]=h[0];a.vector[1]=h[1]};a.prototype.fastMiterJoin=function(a,d,e){e=c(y[0],e);d=h(y[1],e);var b=a.vectors.items[0];b.vector[0]=e[0];b.vector[1]=e[1];b.texCoords[0]=0;b.texCoords[1]=-1;b.direction[0]=0;b.direction[1]=0;e=a.vectors.items[1];e.vector[0]=d[0];e.vector[1]=d[1];e.texCoords[0]=0;e.texCoords[1]=1;e.direction[0]=0;e.direction[1]=0;a.vectors.count=2;d=a.lists[n.ENTRY];d.items[0]=
0;d.items[1]=1;d.count=2;d=a.lists[n.EXIT];d.items[0]=0;d.items[1]=1;d.count=2;a.lists[n.CAP].count=0;a.capCenter=void 0};a.prototype.miterJoin=function(a,e,b){var f=c(y[0],e),r=c(y[1],b),p=y[2];p[0]=f[0]+r[0];p[1]=f[1]+r[1];r=l(y[3],p);f=m(r,f);r=d(y[4],r,1/f);f=h(y[5],r);this._distanceAlongCorrection?(p=a.vectors.items[0],p.vector[0]=r[0],p.vector[1]=r[1],p.texCoords[0]=0,p.texCoords[1]=-1,p.direction[0]=e[0],p.direction[1]=e[1],p=a.vectors.items[1],p.vector[0]=f[0],p.vector[1]=f[1],p.texCoords[0]=
0,p.texCoords[1]=1,p.direction[0]=e[0],p.direction[1]=e[1],e=a.vectors.items[2],e.vector[0]=r[0],e.vector[1]=r[1],e.texCoords[0]=0,e.texCoords[1]=-1,e.direction[0]=b[0],e.direction[1]=b[1],e=a.vectors.items[3],e.vector[0]=f[0],e.vector[1]=f[1],e.texCoords[0]=0,e.texCoords[1]=1,e.direction[0]=b[0],e.direction[1]=b[1],a.vectors.count=4,b=a.lists[n.ENTRY],b.items[0]=0,b.items[1]=1,b.count=2,b=a.lists[n.EXIT],b.items[0]=2,b.items[1]=3):(p=a.vectors.items[0],p.vector[0]=r[0],p.vector[1]=r[1],p.texCoords[0]=
0,p.texCoords[1]=-1,p.direction[0]=0,p.direction[1]=0,p=a.vectors.items[1],p.vector[0]=f[0],p.vector[1]=f[1],p.texCoords[0]=0,p.texCoords[1]=1,p.direction[0]=0,p.direction[1]=0,a.vectors.count=2,b=a.lists[n.ENTRY],b.items[0]=0,b.items[1]=1,b.count=2,b=a.lists[n.EXIT],b.items[0]=0,b.items[1]=1);b.count=2;a.lists[n.CAP].count=0;a.capCenter=void 0};a.prototype.bevelJoin=function(a,b,f,p){var z=p*p;p=e(b,f);var v=0<p?[-1,1]:[1,-1],x=v[0],v=v[1],A=0<p?h(y[0],c(y[1],b)):c(y[2],b),u=0<p?h(y[3],c(y[4],f)):
c(y[5],f),C=y[6];C[0]=A[0]+u[0];C[1]=A[1]+u[1];var w=l(y[7],C),B=h(y[8],w),H=m(w,A),C=e(w,A),F=Math.abs(C/H),C=1+F*F,E=C<J?[F,this._distanceAlongCorrection]:[Math.sqrt(J-1),!0],I=E[0],E=E[1],q=C<z?[F,this._distanceAlongCorrection]:[Math.sqrt(z-1),!0],F=q[0];(q=q[1])&&E?(E=a.vectors.items[0],r(E.vector,h(y[9],A),d(y[10],h(y[11],b),I)),E.texCoords[0]=0,E.texCoords[1]=x,E.direction[0]=this._distanceAlongCorrection?b[0]:0,E.direction[1]=this._distanceAlongCorrection?b[1]:0,B=a.vectors.items[1],r(B.vector,
h(y[12],u),d(y[13],f,I)),B.texCoords[0]=0,B.texCoords[1]=x,B.direction[0]=this._distanceAlongCorrection?f[0]:0,B.direction[1]=this._distanceAlongCorrection?f[1]:0,x=a.vectors.items[2],x.vector[0]=0,x.vector[1]=0,x.texCoords[0]=0,x.texCoords[1]=0,x.direction[0]=0,x.direction[1]=0,x=a.vectors.items[3],r(x.vector,A,d(y[14],b,F)),x.texCoords[0]=0,x.texCoords[1]=v,x.direction[0]=this._distanceAlongCorrection?b[0]:0,x.direction[1]=this._distanceAlongCorrection?b[1]:0,b=a.vectors.items[4],r(b.vector,u,d(y[15],
h(y[16],f),F)),b.texCoords[0]=0,b.texCoords[1]=v,b.direction[0]=this._distanceAlongCorrection?f[0]:0,b.direction[1]=this._distanceAlongCorrection?f[1]:0,a.vectors.count=5,f=a.lists[n.ENTRY],f.items[0]=0,f.items[1]=2,f.items[2]=3,f.count=3,f=a.lists[n.EXIT],f.items[0]=1,f.items[1]=2,f.items[2]=4,f.count=3,C<z?(z=a.lists[n.CAP],z.count=0,a.capCenter=void 0):(z=a.lists[n.CAP],z.items[0]=3,z.items[1]=4,z.count=2,a.capCenter=2)):!q&&E?(E=a.vectors.items[0],r(E.vector,h(y[9],A),d(y[10],h(y[11],b),I)),E.texCoords[0]=
0,E.texCoords[1]=x,E.direction[0]=this._distanceAlongCorrection?b[0]:0,E.direction[1]=this._distanceAlongCorrection?b[1]:0,B=a.vectors.items[1],r(B.vector,h(y[12],u),d(y[13],f,I)),B.texCoords[0]=0,B.texCoords[1]=x,B.direction[0]=this._distanceAlongCorrection?f[0]:0,B.direction[1]=this._distanceAlongCorrection?f[1]:0,x=a.vectors.items[2],x.vector[0]=0,x.vector[1]=0,x.texCoords[0]=0,x.texCoords[1]=0,x.direction[0]=0,x.direction[1]=0,x=a.vectors.items[3],d(x.vector,w,1/H),x.texCoords[0]=0,x.texCoords[1]=
v,x.direction[0]=0,x.direction[1]=0,a.vectors.count=4,f=a.lists[n.ENTRY],f.items[0]=0,f.items[1]=2,f.items[2]=3,f.count=3,f=a.lists[n.EXIT],f.items[0]=1,f.items[1]=2,f.items[2]=3,f.count=3,a.lists[n.CAP].count=0,a.capCenter=void 0):q&&!E?(E=a.vectors.items[0],d(E.vector,B,1/H),E.texCoords[0]=0,E.texCoords[1]=x,E.direction[0]=0,E.direction[1]=0,B=a.vectors.items[1],B.vector[0]=0,B.vector[1]=0,B.texCoords[0]=0,B.texCoords[1]=0,B.direction[0]=0,B.direction[1]=0,x=a.vectors.items[2],r(x.vector,A,d(y[9],
b,F)),x.texCoords[0]=0,x.texCoords[1]=v,x.direction[0]=this._distanceAlongCorrection?b[0]:0,x.direction[1]=this._distanceAlongCorrection?b[1]:0,x=a.vectors.items[3],r(x.vector,u,d(y[10],h(y[11],f),F)),x.texCoords[0]=0,x.texCoords[1]=v,x.direction[0]=this._distanceAlongCorrection?f[0]:0,x.direction[1]=this._distanceAlongCorrection?f[1]:0,a.vectors.count=4,f=a.lists[n.ENTRY],f.items[0]=0,f.items[1]=1,f.items[2]=2,f.count=3,f=a.lists[n.EXIT],f.items[0]=0,f.items[1]=1,f.items[2]=3,f.count=3,C<z?(z=a.lists[n.CAP],
z.count=0,a.capCenter=void 0):(z=a.lists[n.CAP],z.items[0]=2,z.items[1]=3,z.count=2,a.capCenter=1)):q||E||(E=a.vectors.items[0],d(E.vector,B,1/H),E.texCoords[0]=0,E.texCoords[1]=x,E.direction[0]=0,E.direction[1]=0,B=a.vectors.items[1],d(B.vector,w,1/H),B.texCoords[0]=0,B.texCoords[1]=v,B.direction[0]=0,B.direction[1]=0,a.vectors.count=2,f=a.lists[n.ENTRY],f.items[0]=0,f.items[1]=1,f.count=2,f=a.lists[n.EXIT],f.items[0]=0,f.items[1]=1,f.count=2,a.lists[n.CAP].count=0,a.capCenter=void 0);0>p&&(D(a.lists[n.ENTRY]),
D(a.lists[n.EXIT]))};a.prototype.roundJoin=function(a,b,f,p){var z=e(b,f),x=0<z?[-1,1]:[1,-1],u=x[0],x=x[1],C=0<z?h(y[0],c(y[1],b)):c(y[2],b),B=0<z?h(y[3],c(y[4],f)):c(y[5],f),E=y[6];E[0]=C[0]+B[0];E[1]=C[1]+B[1];var w=l(y[7],E),E=h(y[8],w),H=m(w,C),w=e(w,C),w=Math.abs(w/H),q=1+w*w<J?[w,this._distanceAlongCorrection]:[Math.sqrt(J-1),!0],w=q[0];q[1]?(q=a.vectors.items[0],q.vector[0]=C[0],q.vector[1]=C[1],q.texCoords[0]=0,q.texCoords[1]=x,q.direction[0]=0,q.direction[1]=0,q=a.vectors.items[1],q.vector[0]=
B[0],q.vector[1]=B[1],q.texCoords[0]=0,q.texCoords[1]=x,q.direction[0]=0,q.direction[1]=0,q=a.vectors.items[2],r(q.vector,h(y[9],C),d(y[10],h(y[11],b),w)),q.texCoords[0]=0,q.texCoords[1]=u,q.direction[0]=this._distanceAlongCorrection?b[0]:0,q.direction[1]=this._distanceAlongCorrection?b[1]:0,b=a.vectors.items[3],r(b.vector,h(y[12],B),d(y[13],f,w)),b.texCoords[0]=0,b.texCoords[1]=u,b.direction[0]=this._distanceAlongCorrection?f[0]:0,b.direction[1]=this._distanceAlongCorrection?f[1]:0,f=a.vectors.items[4],
f.vector[0]=0,f.vector[1]=0,f.texCoords[0]=0,f.texCoords[1]=0,f.direction[0]=0,f.direction[1]=0,a.vectors.count=5,f=a.lists[n.ENTRY],f.items[0]=2,f.items[1]=4,f.items[2]=0,f.count=3,f=a.lists[n.EXIT],f.items[0]=3,f.items[1]=4,f.items[2]=1,f.count=3,a.capCenter=4):(q=a.vectors.items[0],q.vector[0]=C[0],q.vector[1]=C[1],q.texCoords[0]=0,q.texCoords[1]=x,q.direction[0]=0,q.direction[1]=0,q=a.vectors.items[1],q.vector[0]=B[0],q.vector[1]=B[1],q.texCoords[0]=0,q.texCoords[1]=x,q.direction[0]=0,q.direction[1]=
0,q=a.vectors.items[2],d(q.vector,E,1/H),q.texCoords[0]=0,q.texCoords[1]=u,q.direction[0]=0,q.direction[1]=0,b=a.vectors.items[3],b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,a.vectors.count=4,f=a.lists[n.ENTRY],f.items[0]=2,f.items[1]=3,f.items[2]=0,f.count=3,f=a.lists[n.EXIT],f.items[0]=2,f.items[1]=3,f.items[2]=1,f.count=3,a.capCenter=3);A(v,C,B,p,0>z);p=a.vectors.count;C=a.lists[n.CAP];for(B=C.items[0]=0;B<v.count;++B)f=v.items[B],u=a.vectors.items[p+
B],u.vector[0]=f[0],u.vector[1]=f[1],u.texCoords[0]=0,u.texCoords[1]=x,u.direction[0]=0,u.direction[1]=0,C.items[B+1]=p+B;C.items[v.count+1]=1;C.count=v.count+2;a.vectors.count=p+v.count;0>z&&(D(a.lists[n.ENTRY]),D(a.lists[n.EXIT]))};a.prototype.unitRoundJoin=function(a,d,b,l){var f=e(d,b),m=0<f?[-1,1]:[1,-1],r=m[0],m=m[1];d=0<f?h(y[0],c(y[1],d)):c(y[2],d);b=0<f?h(y[3],c(y[4],b)):c(y[5],b);var p=a.vectors.items[0];p.vector[0]=d[0];p.vector[1]=d[1];p.texCoords[0]=0;p.texCoords[1]=m;p.direction[0]=
0;p.direction[1]=0;p=a.vectors.items[1];p.vector[0]=b[0];p.vector[1]=b[1];p.texCoords[0]=0;p.texCoords[1]=m;p.direction[0]=0;p.direction[1]=0;p=a.vectors.items[2];h(p.vector,d);p.texCoords[0]=0;p.texCoords[1]=r;p.direction[0]=0;p.direction[1]=0;p=a.vectors.items[3];h(p.vector,b);p.texCoords[0]=0;p.texCoords[1]=r;p.direction[0]=0;p.direction[1]=0;r=a.vectors.items[4];r.vector[0]=0;r.vector[1]=0;r.texCoords[0]=0;r.texCoords[1]=0;r.direction[0]=0;r.direction[1]=0;a.vectors.count=5;r=a.lists[n.ENTRY];
r.items[0]=2;r.items[1]=0;r.count=2;r=a.lists[n.EXIT];r.items[0]=3;r.items[1]=1;r.count=2;a.capCenter=4;A(v,d,b,l,0>f);l=a.vectors.count;d=a.lists[n.CAP];for(r=d.items[0]=0;r<v.count;++r)b=v.items[r],p=a.vectors.items[l+r],p.vector[0]=b[0],p.vector[1]=b[1],p.texCoords[0]=0,p.texCoords[1]=m,p.direction[0]=0,p.direction[1]=0,d.items[r+1]=l+r;d.items[v.count+1]=1;d.count=v.count+2;a.vectors.count=l+v.count;0>f&&(D(a.lists[n.ENTRY]),D(a.lists[n.EXIT]))};a.prototype.rectJoin=function(a,d,e){d=c(y[0],d);
e=c(y[1],e);var b=a.vectors.items[0];b.vector[0]=d[0];b.vector[1]=d[1];b.texCoords[0]=0;b.texCoords[1]=-1;b.direction[0]=0;b.direction[1]=0;b=a.vectors.items[1];b.vector[0]=e[0];b.vector[1]=e[1];b.texCoords[0]=0;b.texCoords[1]=-1;b.direction[0]=0;b.direction[1]=0;b=a.vectors.items[2];h(b.vector,d);b.texCoords[0]=0;b.texCoords[1]=1;b.direction[0]=0;b.direction[1]=0;d=a.vectors.items[3];h(d.vector,e);d.texCoords[0]=0;d.texCoords[1]=1;d.direction[0]=0;d.direction[1]=0;a.vectors.count=4;d=a.lists[n.ENTRY];
d.items[0]=0;d.items[1]=2;d.count=2;d=a.lists[n.EXIT];d.items[0]=1;d.items[1]=3;d.count=2;a.capCenter=void 0};return a}();a.Tessellator=q})},"esri/views/vectorTiles/style/StyleLayer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Filter ./StyleDefinition ./StyleProperty".split(" "),function(q,a,b,p,m,f,l){Object.defineProperty(a,"__esModule",{value:!0});q=function(){function a(a,c,d){this.type=a;this.id=c.id;this.source=c.source;this.sourceLayer=
c["source-layer"];this.minzoom=c.minzoom;this.maxzoom=c.maxzoom;this.filter=c.filter;this.layout=c.layout;this.paint=c.paint;this.z=d;switch(a){case 0:this._layoutDefinition=f.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=f.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=f.StyleDefinition.fillLayoutDefinition;this._paintDefinition=f.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=f.StyleDefinition.lineLayoutDefinition;this._paintDefinition=
f.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=f.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=f.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=f.StyleDefinition.circleLayoutDefinition,this._paintDefinition=f.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}a.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:
this._featureFilter=m.createFilter(this.filter)};a.prototype.getLayoutProperty=function(a){var c=this._layoutProperties;if(c)return c[a]};a.prototype.getPaintProperty=function(a){var c=this._paintProperties;if(c)return c[a]};a.prototype.getLayoutValue=function(a,c,d){var e,h=this._layoutProperties;h&&(h=h[a])&&(e=h.getValue(c,d));a=this._layoutDefinition[a];void 0===e&&(e=a["default"]);"enum"===a.type&&(e=a.values.indexOf(e));return e};a.prototype.getPaintValue=function(a,c,d){var e,h=this._paintProperties;
h&&(h=h[a])&&(e=h.getValue(c,d));a=this._paintDefinition[a];void 0===e&&(e=a["default"]);"enum"===a.type&&(e=a.values.indexOf(e));return e};a.prototype._parseLayout=function(a){var c={},d;for(d in a){var e=this._layoutDefinition[d];e&&(c[d]=new l(d,e,a[d]))}return c};a.prototype._parsePaint=function(a){var c={},d;for(d in a){var e=this._paintDefinition[d];e&&(c[d]=new l(d,e,a[d]))}return c};return a}();a.StyleLayer=q;p=function(a){function c(c,d,e){return a.call(this,c,d,e)||this}b(c,a);return c}(q);
a.BackgroundStyleLayer=p;p=function(a){function c(c,d,e){c=a.call(this,c,d,e)||this;d=c.getPaintProperty("fill-color");c.hasDataDrivenColor=d?d.isDataDriven:!1;d=c.getPaintProperty("fill-opacity");c.hasDataDrivenOpacity=d?d.isDataDriven:!1;c.hasDataDrivenFill=c.hasDataDrivenColor||c.hasDataDrivenOpacity;d=c.getPaintProperty("fill-outline-color");c.outlineUsesFillColor=!d;c.hasDataDrivenOutlineColor=d?d.isDataDriven:!1;c.hasDataDrivenOutline=(d?c.hasDataDrivenOutlineColor:c.hasDataDrivenColor)||c.hasDataDrivenOpacity;
return c}b(c,a);return c}(q);a.FillStyleLayer=p;p=function(a){function c(c,d,e){c=a.call(this,c,d,e)||this;d=c.getPaintProperty("line-color");c.hasDataDrivenColor=d?d.isDataDriven:!1;d=c.getPaintProperty("line-opacity");c.hasDataDrivenOpacity=d?d.isDataDriven:!1;d=c.getPaintProperty("line-width");c.hasDataDrivenWidth=d?d.isDataDriven:!1;c.hasDataDrivenLine=c.hasDataDrivenColor||c.hasDataDrivenOpacity||c.hasDataDrivenWidth;return c}b(c,a);return c}(q);a.LineStyleLayer=p;p=function(a){function c(c,
d,e){c=a.call(this,c,d,e)||this;d=c.getPaintProperty("icon-color");c.hasDataDrivenIconColor=d?d.isDataDriven:!1;d=c.getPaintProperty("icon-opacity");c.hasDataDrivenIconOpacity=d?d.isDataDriven:!1;d=c.getLayoutProperty("icon-size");c.hasDataDrivenIconSize=d?d.isDataDriven:!1;c.hasDataDrivenIcon=c.hasDataDrivenIconColor||c.hasDataDrivenIconOpacity||c.hasDataDrivenIconSize;d=c.getPaintProperty("text-color");c.hasDataDrivenTextColor=d?d.isDataDriven:!1;d=c.getPaintProperty("text-opacity");c.hasDataDrivenTextOpacity=
d?d.isDataDriven:!1;d=c.getLayoutProperty("text-size");c.hasDataDrivenTextSize=d?d.isDataDriven:!1;c.hasDataDrivenText=c.hasDataDrivenTextColor||c.hasDataDrivenTextOpacity||c.hasDataDrivenTextSize;return c}b(c,a);return c}(q);a.SymbolStyleLayer=p;q=function(a){function c(c,d,e){c=a.call(this,c,d,e)||this;d=c.getPaintProperty("circle-radius");c.hasDataDrivenRadius=d?d.isDataDriven:!1;d=c.getPaintProperty("circle-color");c.hasDataDrivenColor=d?d.isDataDriven:!1;d=c.getPaintProperty("circle-opacity");
c.hasDataDrivenOpacity=d?d.isDataDriven:!1;d=c.getPaintProperty("circle-stroke-width");c.hasDataDrivenStrokeWidth=d?d.isDataDriven:!1;d=c.getPaintProperty("circle-stroke-color");c.hasDataDrivenStrokeColor=d?d.isDataDriven:!1;d=c.getPaintProperty("circle-stroke-opacity");c.hasDataDrivenStrokeOpacity=d?d.isDataDriven:!1;d=c.getPaintProperty("circle-blur");c.hasDataDrivenBlur=d?d.isDataDriven:!1;return c}b(c,a);return c}(q);a.CircleStyleLayer=q;q=function(){return function(a,e,b){this.cap=a.getLayoutValue("line-cap",
e,b);this.join=a.getLayoutValue("line-join",e,b);this.miterLimit=a.getLayoutValue("line-miter-limit",e,b);this.roundLimit=a.getLayoutValue("line-round-limit",e,b)}}();a.LineLayout=q;q=function(){return function(a,e,b,d){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",e,d);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",e,d);this.optional=a.getLayoutValue("icon-optional",e,d);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",e,d);this.size=a.getLayoutValue("icon-size",
e,d);this.rotate=a.getLayoutValue("icon-rotate",e,d);this.padding=a.getLayoutValue("icon-padding",e,d);this.keepUpright=a.getLayoutValue("icon-keep-upright",e,d);this.offset=a.getLayoutValue("icon-offset",e,d);2===this.rotationAlignment&&(this.rotationAlignment=b?0:1)}}();a.IconLayout=q;q=function(){return function(a,e,b,d){this.allowOverlap=a.getLayoutValue("text-allow-overlap",e,d);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",e,d);this.optional=a.getLayoutValue("text-optional",
e,d);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",e,d);this.fontArray=a.getLayoutValue("text-font",e,d);this.maxWidth=a.getLayoutValue("text-max-width",e,d);this.lineHeight=a.getLayoutValue("text-line-height",e,d);this.letterSpacing=a.getLayoutValue("text-letter-spacing",e,d);this.justify=a.getLayoutValue("text-justify",e,d);this.anchor=a.getLayoutValue("text-anchor",e,d);this.maxAngle=a.getLayoutValue("text-max-angle",e,d);this.size=a.getLayoutValue("text-size",e,d);this.rotate=
a.getLayoutValue("text-rotate",e,d);this.padding=a.getLayoutValue("text-padding",e,d);this.keepUpright=a.getLayoutValue("text-keep-upright",e,d);this.transform=a.getLayoutValue("text-transform",e,d);this.offset=a.getLayoutValue("text-offset",e,d);2===this.rotationAlignment&&(this.rotationAlignment=b?0:1)}}();a.TextLayout=q})},"esri/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(q,a){return function(){function a(b,m,f){this._op=b;"$type"===m?(this._val=f instanceof
Array?f.map(function(b){return a._types.indexOf(b)}):a._types.indexOf(f),this._op+=11):(this._key=m,this._val=f)}a.prototype.filter=function(a){switch(this._op){case 0:return this._val;case 1:return a.values[this._key]===this._val;case 2:return a.values[this._key]!==this._val;case 3:return a.values[this._key]<this._val;case 4:return a.values[this._key]>this._val;case 5:return a.values[this._key]<=this._val;case 6:return a.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(a.values[this._key]);
case 8:return-1===this._val.indexOf(a.values[this._key]);case 9:for(var b=0,f=this._val;b<f.length;b++){var l=f[b];if(l.filter(a))return!0}return!1;case 10:b=0;for(f=this._val;b<f.length;b++)if(l=f[b],!l.filter(a))return!1;return!0;case 11:b=0;for(f=this._val;b<f.length;b++)if(l=f[b],l.filter(a))return!1;return!0;case 12:return a.type===this._val;case 13:return a.type!==this._val;case 14:return a.type<this._val;case 15:return a.type>this._val;case 16:return a.type>=this._val;case 17:return a.type<=
this._val;case 18:return-1!==this._val.indexOf(a.type);case 19:return-1===this._val.indexOf(a.type)}};a.createFilter=function(b){if(!b)return new a(0,void 0,!0);var m=b[0];if(1>=b.length)return new a(0,void 0,"any"!==m);switch(m){case "\x3d\x3d":return new a(1,b[1],b[2]);case "!\x3d":return new a(2,b[1],b[2]);case "\x3e":return new a(4,b[1],b[2]);case "\x3c":return new a(3,b[1],b[2]);case "\x3e\x3d":return new a(6,b[1],b[2]);case "\x3c\x3d":return new a(5,b[1],b[2]);case "in":return new a(7,b[1],
b.slice(2));case "!in":return new a(8,b[1],b.slice(2));case "any":return new a(9,void 0,b.slice(1).map(a.createFilter.bind(this)));case "all":return new a(10,void 0,b.slice(1).map(a.createFilter.bind(this)));case "none":return new a(11,void 0,b.slice(1).map(a.createFilter.bind(this)));default:throw Error("invalid operator: "+m);}};a._types=["Unknown","Point","LineString","Polygon"];return a}()})},"esri/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(q,a){Object.defineProperty(a,
"__esModule",{value:!0});q=function(){function a(){}a.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};a.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};a.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",
default:2},"line-round-limit":{type:"number",default:1.05}};a.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-placement":{type:"enum",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",minimum:1,default:250},"symbol-avoid-edges":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-optional":{type:"boolean",default:!1},
"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"icon-rotate":{type:"number",default:0},"icon-padding":{type:"number",minimum:0,default:2},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-font":{type:"array",value:"string",default:["Open Sans Regular",
"Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,default:16},"text-max-width":{type:"number",minimum:0,default:10},"text-line-height":{type:"number",default:1.2},"text-letter-spacing":{type:"number",default:0},"text-justify":{type:"enum",values:["left","center","right"],default:"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:"center"},"text-max-angle":{type:"number",minimum:0,default:45},"text-rotate":{type:"number",
default:0},"text-padding":{type:"number",minimum:0,default:2},"text-keep-upright":{type:"boolean",default:!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-allow-overlap":{type:"boolean",default:!1},"text-ignore-placement":{type:"boolean",default:!1},"text-optional":{type:"boolean",default:!1}};a.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};
a.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-color":{type:"color",default:[0,0,0,1]},"background-pattern":{type:"string"}};a.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",
values:["map","viewport"],default:"map"},"fill-pattern":{type:"string"}};a.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-color":{type:"color",default:[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-blur":{type:"number",
minimum:0,default:0},"line-dasharray":{type:"array",value:"number",default:[]},"line-pattern":{type:"string"}};a.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",
values:["map","viewport"],default:"map"},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-halo-blur":{type:"number",minimum:0,default:0},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};a.rasterPaintDefinition={"raster-opacity":{type:"number",
minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};a.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",
minimum:0,default:5},"circle-color":{type:"color",default:[0,0,0,1]},"circle-blur":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1}};return a}();a.StyleDefinition=q})},"esri/views/vectorTiles/style/StyleProperty":function(){define(["require",
"exports","../../../Color","../GeometryUtils"],function(q,a,b,p){return function(){function a(b,l,c){this.isDataDriven=!1;switch(l.type){case "number":b=!0;break;case "color":b=!0;c=a._parseColor(c);break;case "array":b="number"===l.value;break;default:b=!1}null==c&&(c=l.default);b&&"interval"===c.type&&(b=!1);var e=c&&c.stops&&0<c.stops.length;if(e)for(var h=0,d=c.stops;h<d.length;h++){var f=d[h];f[1]=this._validate(f[1],l)}if(this.isDataDriven=c&&!!c.property)if(void 0!==c.default&&(c.default=this._validate(c.default,
l)),e)switch(c.type){case "identity":this.getValue=this._buildIdentity(c,l);break;case "categorical":this.getValue=this._buildCategorical(c,l);break;default:this.getValue=b?this._buildInterpolate(c,l):this._buildInterval(c,l)}else this.getValue=this._buildIdentity(c,l);else e?this.getValue=b?this._buildZoomInterpolate(c):this._buildZoomInterval(c):(c=this._validate(c,l),this.getValue=this._buildSimple(c))}a.prototype._validate=function(a,b){if("number"===b.type){if(a<b.minimum)return b.minimum;if(a>
b.maximum)return b.maximum}return a};a.prototype._buildSimple=function(a){return function(){return a}};a.prototype._buildIdentity=function(b,l){var c=this;return function(e,h){var d;h&&(d=h.values[b.property],"color"===l.type&&(d=a._parseColor(d)));void 0===d&&(d=b.default);return void 0!==d?c._validate(d,l):l.default}};a.prototype._buildCategorical=function(a,b){var c=this;return function(e,h){var d;h&&(d=h.values[a.property]);d=c._categorical(d,a.stops);return void 0!==d?d:void 0!==a.default?a.default:
b.default}};a.prototype._buildInterval=function(a,b){var c=this;return function(e,h){var d;h&&(d=h.values[a.property]);return"number"===typeof d?c._interval(d,a.stops):void 0!==a.default?a.default:b.default}};a.prototype._buildInterpolate=function(a,b){var c=this;return function(e,h){var d;h&&(d=h.values[a.property]);return"number"===typeof d?c._interpolate(d,a.stops,a.base||1):void 0!==a.default?a.default:b.default}};a.prototype._buildZoomInterpolate=function(a){var b=this;return function(c){return b._interpolate(c,
a.stops,a.base||1)}};a.prototype._buildZoomInterval=function(a){var b=this;return function(c){return b._interval(c,a.stops)}};a.prototype._categorical=function(a,b){for(var c=b.length,e=0;e<c;e++)if(b[e][0]===a)return b[e][1]};a.prototype._interval=function(a,b){for(var c=b.length,e=0,h=0;h<c;h++)if(b[h][0]<=a)e=h;else break;return b[e][1]};a.prototype._interpolate=function(a,b,c){for(var e,h,d=b.length,l=0;l<d;l++){var f=b[l];if(f[0]<=a)e=f;else{h=f;break}}if(e&&h){l=h[0]-e[0];a-=e[0];c=1===c?a/
l:(Math.pow(c,a)-1)/(Math.pow(c,l)-1);if(Array.isArray(e[1])){e=e[1];h=h[1];a=[];for(l=0;l<e.length;l++)a.push(p.interpolate(e[l],h[l],c));return a}return p.interpolate(e[1],h[1],c)}if(e)return e[1];if(h)return h[1]};a._isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};a._parseColor=function(f){if(Array.isArray(f))return f;if("string"===typeof f){if(f=new b(f),!this._isEmpty(f))return b.toUnitRGBA(f)}else return f&&f.default&&(f.default=a._parseColor(f.default)),f&&f.stops&&
(f.stops=f.stops.map(function(b){return[b[0],a._parseColor(b[1])]})),f};return a}()})},"esri/Color":function(){define(["./core/declare","./core/accessorSupport/ensureType","dojo/colors"],function(q,a,b){function p(b){return Math.max(0,Math.min(a.ensureInteger(b),255))}var m=q([b],{declaredClass:"esri.Color",toJSON:function(){return[p(this.r),p(this.g),p(this.b),1<this.a?this.a:p(255*this.a)]},clone:function(){return new m(this.toRgba())}});m.toJSON=function(a){return a&&[p(a.r),p(a.g),p(a.b),1<a.a?
a.a:p(255*a.a)]};m.fromJSON=function(a){return a&&new m([a[0],a[1],a[2],a[3]/255])};m.toUnitRGB=function(a){return[a.r/255,a.g/255,a.b/255]};m.toUnitRGBA=function(a){return[a.r/255,a.g/255,a.b/255,null!=a.a?a.a:1]};var f="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(q=0;q<f.length;q++)m[f[q]]=b[f[q]];m.named.rebeccapurple=[102,51,153];return m})},"esri/core/declare":function(){define(["require","exports","dojo/_base/declare"],function(q,a,b){function p(a,e){a&&!Array.isArray(a)&&
"function"!==typeof a&&(e=a,a=null);a=a||[];e=e||{};return m([this].concat(a),e)}function m(a,e){a&&!Array.isArray(a)&&"function"!==typeof a&&(e=a,a=null);"function"===typeof a?a=[a]:a||(a=[]);e=e||{};var c,d;c=0;for(d=f.length;c<d;c++)f[c](a,e);a=b(a,e);a.createSubclass=p;c=0;for(d=l.length;c<d;c++)l[c](a);return a}var f=[],l=[];(function(a){a.hasMixin=function(a,c){a=Array.isArray(a)?a.reduce(function(a,c){return c._meta?a.concat(c._meta.bases):a},[]):a._meta?a._meta.bases:a;if(!a)return!1;if("string"===
typeof c)for(var d=a.length-1;0<=d;d--)if(a[d].prototype.declaredClass===c)return!0;return-1!==a.indexOf(c)};a.safeMixin=function(a,c){return b.safeMixin(a,c)};a.before=function(a){f.push(a)};a.after=function(a){l.push(a)}})(m||(m={}));return m})},"esri/core/accessorSupport/ensureType":function(){define(["require","exports","../Logger"],function(q,a,b){function p(a,c){return c.isInstanceOf?c.isInstanceOf(a):c instanceof a}function m(a){return null==a?a:new Date(a)}function f(a){return null==a?a:!!a}
function l(a){return null==a?a:a.toString()}function c(a){return null==a?a:parseFloat(a)}function e(a){return null==a?a:Math.round(parseFloat(a))}function h(a){return a&&a.constructor&&void 0!==a.constructor._meta}function d(a,c){return null!=c&&a&&!p(a,c)}function r(a,c){d(a,c)&&(h(c)?B.error("Accessor#set","Assigning an instance of '"+(c.declaredClass||"unknown")+"' which is not a subclass of '"+(a&&a.prototype&&a.prototype.declaredClass||"unknown")+"'"):c=new a(c));return c}function z(a){switch(a){case Number:return c;
case C:return e;case Boolean:return f;case String:return l;case Date:return m;default:return r.bind(null,a)}}function A(a,c){var d=z(a);return 1===arguments.length?d:d(c)}function D(a,c){return 1===arguments.length?D.bind(null,a):c?Array.isArray(c)?c.map(a):[a(c)]:c}function n(a,c,d){return 0!==c&&Array.isArray(d)?d.map(function(d){return n(a,c-1,d)}):a(d)}function x(a,c,d){if(2===arguments.length)return x.bind(null,a,c);if(!d)return d;d=n(a,c,d);for(var e=c,b=d;0<e&&Array.isArray(b);)e--,b=b[0];
if(void 0!==b)for(b=0;b<e;b++)d=[d];return d}function J(a,c){if(2===arguments.length)return J(a).call(null,c);var e={},b=[],l=[],f;for(f in a.typeMap){var n=a.typeMap[f];e[f]=A(n);b.push(n&&n.prototype&&n.prototype.declaredClass||"unknown");l.push(f)}var m="string"===typeof a.key?function(c){return c[a.key]}:a.key;return function(c){if(a.base&&!d(a.base,c))return c;var f=m(c)||a.defaultKeyValue,n=e[f];if(!n)return B.error("Accessor#set","Invalid property value, value needs to be one of "+("'"+b.join("', '")+
"'")+", or a plain object that can auto-cast (having .type \x3d "+("'"+l.join("', '")+"'")+")"),null;if(!d(a.typeMap[f],c))return c;if("string"!==typeof a.key||h(c))return n(c);var f={},r;for(r in c)r!==a.key&&(f[r]=c[r]);return n(f)}}Object.defineProperty(a,"__esModule",{value:!0});var B=b.getLogger("esri.core.Accessor");a.isInstanceOf=p;a.ensureDate=m;a.ensureBoolean=f;a.ensureString=l;a.ensureNumber=c;a.ensureInteger=e;a.isClassedType=h;a.requiresType=d;a.ensureClass=r;a.ensureType=A;a.ensureArrayTyped=
D;a.ensureArray=function(a,c){return 1===arguments.length?D(A.bind(null,a)):D(A.bind(null,a),c)};a.ensureNArrayTyped=x;a.ensureNArray=function(a,c,d){return 2===arguments.length?x(A.bind(null,a),c):x(A.bind(null,a),c,d)};a.ensureOneOfType=J;var C=function(){return function(){}}();a.Integer=C;a.default=A})},"esri/core/Logger":function(){define(["require","exports","dojo/has"],function(q,a,b){var p={info:0,warn:1,error:2};q=function(){function a(b){void 0===b&&(b={});this.module=b.module||"";this.writer=
b.writer||null;this.level=b.level||null;null!=b.enabled&&(this.enabled=!!b.enabled);a._loggers[this.module]=this;b=this.module.lastIndexOf(".");-1!==b&&(this.parent=a.getLogger(this.module.slice(0,b)))}a.prototype.log=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this._isEnabled()&&this._matchLevel(a)&&(c=this._inheritedWriter())&&c.apply(void 0,[a,this.module].concat(b))};a.prototype.error=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log.apply(this,
["error"].concat(a))};a.prototype.warn=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log.apply(this,["warn"].concat(a))};a.prototype.info=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log.apply(this,["info"].concat(a))};a.prototype.getLogger=function(b){return a.getLogger(this.module+"."+b)};a.getLogger=function(b){var l=a._loggers[b];l||(l=new a({module:b}));return l};a.prototype._parentWithMember=function(a,b){for(var c=this;c&&null==c[a];)c=
c.parent;return c?c[a]:b};a.prototype._inheritedWriter=function(){return this._parentWithMember("writer",this._consoleWriter)};a.prototype._consoleWriter=function(a,b){for(var c=[],e=2;e<arguments.length;e++)c[e-2]=arguments[e];console[a].apply(console,["["+b+"]"].concat(c))};a.prototype._matchLevel=function(a){return p[this._parentWithMember("level","error")]<=p[a]};a.prototype._isEnabled=function(){return this._parentWithMember("enabled",!0)};a._loggers={};return a}();q.getLogger("esri").level=
"warn";return q})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(q,a,b,p){var m={};a.setObject("dojo.colors",m);var f=function(a,e,b){0>b&&++b;1<b&&--b;var c=6*b;return 1>c?a+(e-a)*c:1>2*b?e:2>3*b?a+(e-a)*(2/3-b)*6:a};q.colorFromRgb=b.fromRgb=function(a,e){var c=a.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(c){a=c[2].split(/\s*,\s*/);var d=a.length,c=c[1];if("rgb"==c&&3==d||"rgba"==c&&4==d)return c=a[0],"%"==c.charAt(c.length-
1)?(c=p.map(a,function(a){return 2.56*parseFloat(a)}),4==d&&(c[3]=a[3]),b.fromArray(c,e)):b.fromArray(a,e);if("hsl"==c&&3==d||"hsla"==c&&4==d){var c=(parseFloat(a[0])%360+360)%360/360,l=parseFloat(a[1])/100,m=parseFloat(a[2])/100,l=.5>=m?m*(l+1):m+l-m*l,m=2*m-l,c=[256*f(m,l,c+1/3),256*f(m,l,c),256*f(m,l,c-1/3),1];4==d&&(c[3]=a[3]);return b.fromArray(c,e)}}return null};var l=function(a,e,b){a=Number(a);return isNaN(a)?b:a<e?e:a>b?b:a};b.prototype.sanitize=function(){this.r=Math.round(l(this.r,0,255));
this.g=Math.round(l(this.g,0,255));this.b=Math.round(l(this.b,0,255));this.a=l(this.a,0,1);return this};m.makeGrey=b.makeGrey=function(a,e){return b.fromArray([a,a,a,e])};a.mixin(b.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,
80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,
206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,
240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,
0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,
232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,
250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return b})},"esri/views/vectorTiles/Placement":function(){define(["require","exports","../2d/engine/webgl/Geometry","./Conflict","./GeometryUtils"],function(q,a,b,p,m){Object.defineProperty(a,"__esModule",{value:!0});q=function(){return function(a,c,b,l,f){void 0===b&&(b=
0);void 0===l&&(l=-1);void 0===f&&(f=e);this.x=a;this.y=c;this.angle=b;this.segment=l;this.minzoom=f}}();a.Anchor=q;var f=function(){return function(a,c,b,l,f,p,n){void 0===f&&(f=!1);void 0===p&&(p=e);void 0===n&&(n=m.C_INFINITY);this.anchor=a;this.labelAngle=c;this.glyphAngle=b;this.page=l;this.upsideDown=f;this.minzoom=p;this.maxzoom=n}}(),l=function(){return function(a,c,e,b,l,f,n,m,p,B){this.tl=a;this.tr=c;this.bl=e;this.br=b;this.mosaicRect=l;this.labelAngle=f;this.anchor=n;this.minzoom=m;this.maxzoom=
p;this.page=B}}();a.PlacedSymbol=l;var c=function(){return function(a,c){this.footprint=a;this.shapes=c}}();a.Placement=c;var e=.5;q=function(){function a(){this.mapAngle=0;this._conflictEngine=new p.ConflictEngine}a.prototype.reset=function(){this._conflictEngine.reset()};a.prototype.setAngle=function(a){this.mapAngle=a;this._conflictEngine.setAngle(a)};a.prototype.getIconPlacement=function(a,h,f,A,D,n,x){var d=f.width/f.pixelRatio,r=f.height/f.pixelRatio;D=n.offset[0]-d/2;var z=n.offset[1]-r/2,
d=D+d,r=z+r,y=f.rect,v=f.sdf?17:2,u=D-v,q=z-v,H=u+y.width/f.pixelRatio,P=q+y.height/f.pixelRatio;f=new b.Point(u,q);v=new b.Point(H,P);P=new b.Point(u,P);q=new b.Point(H,q);H=n.rotate*m.C_DEG_TO_RAD;u=1===n.rotationAlignment;0<=a.segment&&!u&&(H+=a.angle);if(0!==H){var O=Math.cos(H),Q=Math.sin(H);f.rotate(O,Q);v.rotate(O,Q);P.rotate(O,Q);q.rotate(O,Q)}O=8*n.padding;Q=new b.Point(a.x,a.y);a=new p.Footprint(this.mapAngle,O,u);a.addBox(Q,new p.Box(D,z,d,r),A,H,h,e,m.C_INFINITY);h=new l(f,q,P,v,y,0,Q,
e,m.C_INFINITY,0);h=new c(a,[h]);A=e;n.allowOverlap||(A=this._conflictEngine.getMinZoom(h.footprint,A,x,u));a.minzoom=A;return h};a.prototype.getTextPlacement=function(a,h,z,A,D,n,x,J){for(var d=new b.Point(a.x,a.y),r=x.rotate*m.C_DEG_TO_RAD,y=0===x.rotationAlignment,v=x.keepUpright,u=e,q=!y,H=q?0:a.angle,P=0<=a.segment&&y,O=new p.Footprint(this.mapAngle,8*x.padding,q),Q=[],R=!P,L=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,G=L,w=S,I=P?v:y&&v,F,U=0;U<A.length;U++){var T=A[U],K=T.glyphMosaicItem;
if(K&&!K.rect.isEmpty){var V=K.rect,Z=K.metrics,Y=K.page;R&&(F&&F!==T.y&&(O.addBox(d,new p.Box(L,G,S,w),D,r,h,e,m.C_INFINITY),L=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,G=L,w=S),F=T.y);var ga=[];if(P){if(K=(z.x+T.x+Z.left-4+.5*K.metrics.width)*D,u=this._placeGlyph(a,u,K,n,a.segment,1,Y,ga),v&&(u=this._placeGlyph(a,u,K,n,a.segment,-1,Y,ga)),2<=u)break}else ga.push(new f(d,H,H,Y)),y&&v&&ga.push(new f(d,H+m.C_PI,H+m.C_PI,Y,!0));for(var Y=T.x+z.x+Z.left,T=T.y+z.y-Z.top,K=Y+Z.width,Z=T+Z.height,
ba=new b.Point(Y-4,T-4),fa=new b.Point(ba.x+V.width,ba.y+V.height),ca=new b.Point(ba.x,fa.y),ha=new b.Point(fa.x,ba.y),X=0;X<ga.length;X++){var aa=ga[X],ka=ba.clone(),la=ca.clone(),ma=ha.clone(),na=fa.clone(),ja=T,oa=Z,da=aa.glyphAngle+r;if(0!==da){var M=Math.cos(da),W=Math.sin(da);ka.rotate(M,W);na.rotate(M,W);la.rotate(M,W);ma.rotate(M,W)}Q.push(new l(ka,ma,la,na,V,aa.labelAngle,aa.anchor,aa.minzoom,aa.maxzoom,aa.page));if(!I||this._legible(aa.labelAngle))R?(Y<L&&(L=Y),ja<G&&(G=ja),K>S&&(S=K),oa>
w&&(w=oa)):2>aa.minzoom&&O.addBox(aa.anchor,new p.Box(Y,ja,K,oa),D,da,h,aa.minzoom,aa.maxzoom)}}}if(2<=u)return null;R&&O.addBox(d,new p.Box(L,G,S,w),D,r,h,e,m.C_INFINITY);a=new c(O,Q);x.allowOverlap||(u=this._conflictEngine.getMinZoom(a.footprint,u,J,q));O.minzoom=u;return a};a.prototype.add=function(a){this._conflictEngine.add(a.footprint)};a.prototype._legible=function(a){a=m.radToByte(a);return 65>a||193<=a};a.prototype._placeGlyph=function(a,c,e,h,l,n,p,J){var d=0>n?m.positiveMod(a.angle+m.C_PI,
m.C_2PI):a.angle,r=this._legible(d),x=0;0>e&&(n*=-1,e*=-1,x=m.C_PI);0<n&&++l;a=new b.Point(a.x,a.y);var z=h[l],D=m.C_INFINITY;if(h.length<=l)return D;for(;;){var A=z.x-a.x,q=z.y-a.y,P=Math.sqrt(A*A+q*q),O=Math.max(e/P,c),A=m.positiveMod(Math.atan2(q/P,A/P)+x,m.C_2PI);J.push(new f(a,d,A,p,r,O,D));if(O<=c)return O;a=z.clone();do{l+=n;if(h.length<=l||0>l)return O;z=h[l]}while(a.isEqual(z));D=z.x-a.x;A=z.y-a.y;q=Math.sqrt(D*D+A*A);D*=P/q;A*=P/q;a.x-=D;a.y-=A;D=O}};return a}();a.PlacementEngine=q})},"esri/views/vectorTiles/Conflict":function(){define(["require",
"exports","../2d/engine/webgl/Geometry","./GeometryUtils"],function(q,a,b,p){Object.defineProperty(a,"__esModule",{value:!0});q=function(){function a(a,e,b,d){this.left=a;this.top=e;this.right=b;this.bottom=d}a.prototype.clone=function(){return new a(this.left,this.top,this.right,this.bottom)};a.prototype.move=function(a,e){this.left+=a;this.top+=e;this.right+=a;this.bottom+=e};a.prototype.rotate=function(a,e){var c=this.left,d=this.right,b=this.top,l=this.bottom,f=c*a-b*e,m=c*e+b*a,n=d*a-b*e,b=d*
e+b*a,p=c*a-l*e,c=c*e+l*a,J=d*a-l*e;a=d*e+l*a;this.left=Math.min(f,n,p,J);this.top=Math.min(m,b,c,a);this.right=Math.max(f,n,p,J);this.bottom=Math.max(m,b,c,a)};a.overlaps=function(a,e){return a.right>e.left&&a.left<e.right&&a.bottom>e.top&&a.top<e.bottom};return a}();a.Box=q;var m=function(){function a(a,e,b,d){this.anchor=a;this.corners=e;this.minzoom=b;this.maxzoom=d}a.prototype.left=function(){return this.corners[0].x};a.prototype.right=function(){return this.corners[2].x};a.prototype.top=function(){return this.corners[1].y};
a.prototype.bottom=function(){return this.corners[3].y};return a}();a.Obstacle=m;q=function(){function a(a,e,b){this.obstacles=[];this.mapAngle=a;this.padding=e;this.isScreenAligned=b;this.minzoom=f}a.prototype.addBox=function(a,e,h,d,f,l,p){var c=e.left*h-this.padding,n=e.top*h-this.padding,r=e.right*h+this.padding;e=e.bottom*h+this.padding;c=[new b.Point(c,n),new b.Point(r,n),new b.Point(r,e),new b.Point(c,e)];0!==this.mapAngle&&(n=Math.cos(this.mapAngle),r=Math.sin(this.mapAngle),a=a.clone(),a.rotate(n,
r));this.isScreenAligned||(d+=this.mapAngle);if(0!==d){n=Math.cos(d);r=Math.sin(d);c[0].rotate(n,r);c[1].rotate(n,r);c[2].rotate(n,r);c[3].rotate(n,r);d=0;for(n=1;4>n;n++)c[n].x<c[d].x?d=n:c[n].x===c[d].x&&c[n].y<c[d].y&&(d=n);if(d){r=[];for(n=0;4>n;n++)r.push(c[(n+d)%4]);c=r}}if(f)for(d=0,n=c;d<n.length;d++)n[d].move(f[0],f[1]);this.obstacles.push(new m(a,c,l,p))};return a}();a.Footprint=q;var f=.5;q=function(){function a(){this._grid=[]}a.prototype.setAngle=function(a){};a.prototype.reset=function(){this._grid=
[]};a.prototype.add=function(c){var b=this._grid,h=0;for(c=c.obstacles;h<c.length;h++)for(var d=c[h],f=d.anchor,l=a._gridClamp(Math.min(d.left()+f.x,f.x)),m=a._gridClamp(Math.max(d.right()+f.x,f.x)),p=a._gridClamp(Math.min(d.top()+f.y,f.y)),f=a._gridClamp(Math.max(d.bottom()+f.y,f.y));p<=f;p++)for(var n=l;n<=m;n++){var x=b[16*p+n];x||(x=b[16*p+n]=[]);x.push(d)}};a.prototype.getMinZoom=function(c,b,h,d){if(0===c.obstacles.length)return p.C_INFINITY;h=this._grid;d=0;for(c=c.obstacles;d<c.length;d++)for(var e=
c[d],f=e.anchor,l=a._gridClamp(Math.min(e.left()+f.x,f.x)),m=a._gridClamp(Math.max(e.right()+f.x,f.x)),n=a._gridClamp(Math.min(e.top()+f.y,f.y)),f=a._gridClamp(Math.max(e.bottom()+f.y,f.y));n<=f;n++)for(var x=l;x<=m;x++){var J=h[16*n+x];if(J)for(var B=0;B<J.length;B++){var C=J[B];if(!(e.minzoom>=C.maxzoom||C.minzoom>=e.maxzoom)&&(b=a._calcPlacementZoom(e,C,b),2<=b))return p.C_INFINITY}}return 2>b?b:p.C_INFINITY};a._gridClamp=function(a){return p.clamp(a>>9,-7,8)};a._calcPlacementZoom=function(c,b,
h){var d=b.anchor.x-c.anchor.x;if(0===d&&(c.right()<b.left()||b.right()<c.left()))return h;var e=b.anchor.y-c.anchor.y;if(0===e&&(c.bottom()<b.top()||b.bottom()<c.top()))return h;var f=p.C_INFINITY;if(0!==d){var l=(0<d?c.right()-b.left():c.left()-b.right())/d;l<f&&(f=l);d=0<d?a._calcExtZoomX(c,b,l):a._calcExtZoomX(b,c,l);d<f&&(f=d)}0!==e&&(d=(0<e?c.bottom()-b.top():c.top()-b.bottom())/e,d<f&&(f=d),e=0<e?a._calcExtZoomY(c,b,d):a._calcExtZoomY(b,c,d),e<f&&(f=e));if(f<c.minzoom||f<b.minzoom)return h;
f=Math.min(f,c.maxzoom,b.maxzoom);f<h&&(f=h);return f};a._calcExtZoomX=function(a,b,h){var c,e,f;if(a.anchor.y+a.corners[2].y/h<b.anchor.y+b.corners[0].y/h){c=a.corners[2].x-a.corners[3].x;f=a.corners[2].y-a.corners[3].y;var l=b.corners[1].x-b.corners[0].x;e=b.corners[1].y-b.corners[0].y;0<=c*e-f*l?a.anchor.y+a.corners[3].y/h<b.anchor.y+b.corners[0].y/h?(h=a.corners[3],c=b.corners[0],e=b.corners[1],f=1):(h=b.corners[0],c=a.corners[3],e=a.corners[2],f=-1):a.anchor.y+a.corners[2].y/h>b.anchor.y+b.corners[1].y/
h?(h=a.corners[2],c=b.corners[0],e=b.corners[1],f=1):(h=b.corners[1],c=a.corners[3],e=a.corners[2],f=-1)}else c=a.corners[2].x-a.corners[1].x,f=a.corners[2].y-a.corners[1].y,l=b.corners[3].x-b.corners[0].x,e=b.corners[3].y-b.corners[0].y,0>c*e-f*l?a.anchor.y+a.corners[1].y/h>b.anchor.y+b.corners[0].y/h?(h=a.corners[1],c=b.corners[0],e=b.corners[3],f=1):(h=b.corners[0],c=a.corners[1],e=a.corners[2],f=-1):a.anchor.y+a.corners[2].y/h<b.anchor.y+b.corners[3].y/h?(h=a.corners[2],c=b.corners[0],e=b.corners[3],
f=1):(h=b.corners[3],c=a.corners[1],e=a.corners[2],f=-1);l=e.x-c.x;e=e.y-c.y;return f*((h.y-c.y)*l-(h.x-c.x)*e)/((a.anchor.x-b.anchor.x)*e-(a.anchor.y-b.anchor.y)*l)};a._calcExtZoomY=function(a,b,f){var c,e,h;if(a.anchor.x+a.corners[3].x/f<b.anchor.x+b.corners[1].x/f){c=a.corners[3].x-a.corners[2].x;h=a.corners[3].y-a.corners[2].y;var l=b.corners[0].x-b.corners[1].x;e=b.corners[0].y-b.corners[1].y;0>c*e-h*l?a.anchor.x+a.corners[2].x/f<b.anchor.x+b.corners[1].x/f?(f=a.corners[2],c=b.corners[1],e=b.corners[0],
h=1):(f=b.corners[1],c=a.corners[2],e=a.corners[3],h=-1):a.anchor.x+a.corners[3].x/f>b.anchor.x+b.corners[0].x/f?(f=a.corners[3],c=b.corners[1],e=b.corners[0],h=1):(f=b.corners[0],c=a.corners[2],e=a.corners[3],h=-1)}else c=a.corners[3].x-a.corners[0].x,h=a.corners[3].y-a.corners[0].y,l=b.corners[2].x-b.corners[1].x,e=b.corners[2].y-b.corners[1].y,0<c*e-h*l?a.anchor.x+a.corners[0].x/f>b.anchor.x+b.corners[1].x/f?(f=a.corners[0],c=b.corners[1],e=b.corners[2],h=1):(f=b.corners[1],c=a.corners[0],e=a.corners[3],
h=-1):a.anchor.x+a.corners[3].x/f<b.anchor.x+b.corners[2].x/f?(f=a.corners[3],c=b.corners[1],e=b.corners[2],h=1):(f=b.corners[2],c=a.corners[0],e=a.corners[3],h=-1);l=e.x-c.x;e=e.y-c.y;return h*((f.y-c.y)*l-(f.x-c.x)*e)/((a.anchor.x-b.anchor.x)*e-(a.anchor.y-b.anchor.y)*l)};return a}();a.ConflictEngine=q})},"esri/views/vectorTiles/SymbolBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojox/string/BidiEngine ../2d/engine/webgl/Geometry ../2d/engine/webgl/TextShaping ./Bucket ./GeometryUtils ./Placement ./style/StyleLayer".split(" "),
function(q,a,b,p,m,f,l,c,e,h,d){function r(a,c){if(a.iconMosaicItem&&c.iconMosaicItem){if(a.iconMosaicItem.page!==c.iconMosaicItem.page)return a.iconMosaicItem.page<c.iconMosaicItem.page?-1:1}else{if(a.iconMosaicItem&&!c.iconMosaicItem)return 1;if(!a.iconMosaicItem&&c.iconMosaicItem)return-1}return 0}(function(){return function(){}})();return function(a){function c(c,b,d,e,f,h,l,m){b=a.call(this,c,b)||this;b._markerMap=new Map;b._glyphMap=new Map;b._glyphBufferDataStorage=new Map;b._sdfMarkers=!1;
if(c.hasDataDrivenIcon!==d.isDataDriven())throw Error("incompatible icon buffer");if(c.hasDataDrivenText!==f.isDataDriven())throw Error("incompatible text buffer");b._iconVertexBuffer=d;b._iconIndexBuffer=e;b._textVertexBuffer=f;b._textIndexBuffer=h;b._placementEngine=l;b._workerTileHandler=m;return b}b(c,a);Object.defineProperty(c.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sdfMarker",{get:function(){return this._sdfMarkers},enumerable:!0,configurable:!0});c.prototype.copy=function(a,b,d,e,f){a=new c(this.layer,this.zoom,a,b,d,e,f,this._workerTileHandler);a.layerIndex=this.layerIndex;a.layerExtent=this.layerExtent;a._iconIndexStart=b.index;a._textIndexStart=e.index;a._iconIndexCount=0;a._textIndexCount=0;a._symbolInstances=this._symbolInstances;a._workerTileHandler=this._workerTileHandler;a._fontArray=
this._fontArray;a._textLayout=this._textLayout;a._iconLayout=this._iconLayout;a._isLinePlacement=this._isLinePlacement;a._avoidEdges=this._avoidEdges;return a};c.prototype.getResources=function(a,b,d){var e=this.layer,f=this.zoom,h=e.hasDataDrivenIcon,l=e.hasDataDrivenText;a&&a.setExtent(this.layerExtent);for(var n=e.getLayoutProperty("icon-image"),m=e.getLayoutProperty("text-field"),p=e.getLayoutValue("text-font",f),r=e.getLayoutValue("text-transform",f),x=[],D=[1,1,1,1],z=1,q=1,A=[1,1,1,1],S=1,
G=1,w=0,I=this._features;w<I.length;w++){var F=I[w],U=F.getGeometry(a);if(U&&0!==U.length){var T=void 0;n&&(T=e.getLayoutValue("icon-image",f,F),n.isDataDriven||(T=this._replaceKeys(T,F.values)),T&&b.add(T));var K=void 0,V=!1;if(m&&(K=e.getLayoutValue("text-field",f,F),m.isDataDriven||(K=this._replaceKeys(K,F.values)),K=K.replace(/\\n/g,"\n"))){switch(r){case 2:K=K.toLowerCase();break;case 1:K=K.toUpperCase()}c._bidiEngine.hasBidiChar(K)&&(V=void 0,V="rtl"===c._bidiEngine.checkContextual(K)?"IDNNN":
"ICNNN",K=c._bidiEngine.bidiTransform(K,V,"VLYSN"),V=!0);var Z=K.length;if(0<Z)for(var Y=0,ga=p;Y<ga.length;Y++){var ba=ga[Y],fa=d[ba];fa||(fa=d[ba]=new Set);for(ba=0;ba<Z;ba++){var ca=K.charCodeAt(ba);fa.add(ca)}}}if(T||K)Z=e.getLayoutValue("icon-size",f,F),Y=e.getLayoutValue("text-size",f,F),e.hasDataDrivenIconColor&&(D=e.getPaintValue("icon-color",f,F)),e.hasDataDrivenIconOpacity&&(z=e.getPaintValue("icon-opacity",f,F)),e.hasDataDrivenIconSize&&(q=Z),e.hasDataDrivenTextColor&&(A=e.getPaintValue("text-color",
f,F)),e.hasDataDrivenTextOpacity&&(S=e.getPaintValue("text-opacity",f,F)),e.hasDataDrivenTextSize&&(G=Y),F={sprite:T,label:K,rtl:V,type:F.type,geometry:U,iconSize:Z,iconRotate:e.getLayoutValue("icon-rotate",f,F),ddIconValues:h?{color:D,opacity:z,size:q}:null,textSize:Y,textRotate:e.getLayoutValue("text-rotate",f,F),ddTextValues:l?{color:A,opacity:S,size:G}:null},x.push(F)}}this._symbolFeatures=x};c.prototype.processFeatures=function(a,b){a&&a.setExtent(this.layerExtent);var f=this.layer,n=this.zoom;
b=this._isLinePlacement=1===f.getLayoutValue("symbol-placement",n);a=this._avoidEdges=f.getLayoutValue("symbol-avoid-edges",n)&&!b;var m=8*f.getLayoutValue("symbol-spacing",n),p=f.getLayoutProperty("icon-image"),y=f.getLayoutProperty("text-field"),D=this._workerTileHandler,u,z;p&&(this._iconLayout=new d.IconLayout(f,n,b),u=D.getSpriteItems(),z=this._getTranslate(!0));var q,A,O;if(y){q=this._textLayout=new d.TextLayout(f,n,b);this._fontArray=q.fontArray;O=.5;switch(q.anchor){case 5:case 1:case 7:O=
0;break;case 6:case 2:case 8:O=1}A=.5;switch(q.anchor){case 5:case 3:case 6:A=0;break;case 7:case 4:case 8:A=1}f=.5;switch(q.justify){case 0:f=0;break;case 2:f=1}var n=24*q.letterSpacing,p=b?0:24*q.maxWidth,y=24*q.lineHeight,Q=[24*q.offset[0],24*q.offset[1]];q=this._fontArray.map(function(a){return D.getGlyphItems(a)});A=new l(q,p,y,n,Q,O,A,f);O=this._getTranslate(!1)}this._iconIndexStart=this._iconIndexBuffer.index;this._textIndexStart=this._textIndexBuffer.index;this._textIndexCount=this._iconIndexCount=
0;this._markerMap.clear();this._glyphMap.clear();this._symbolInstances=f=[];n=this._textLayout;p=1;n&&n.size&&(p=n.size/24);y=n?n.maxAngle*e.C_DEG_TO_RAD:0;q=n?8*n.size:0;for(var Q=0,R=this._symbolFeatures;Q<R.length;Q++){var L=R[Q],S=void 0;L.sprite&&(S=u[L.sprite])&&S.sdf&&(this._sdfMarkers=!0);var G=void 0,w=L.label,I=0;if(w&&(G=A.getShaping(w,L.rtl))&&0<G.length){for(var I=1E30,w=-1E30,F=0,U=G;F<U.length;F++)var T=U[F],I=Math.min(I,T.x),w=Math.max(w,T.x);I=(w-I+48)*p*8}w=0;for(F=L.geometry;w<
F.length;w++){var U=F[w],K=void 0;b?(G&&0<G.length&&n&&n.size&&c._smoothVertices(U,8*n.size*(2+Math.min(2,4*Math.abs(n.offset[1])))),K=c._findAnchors(U,m,I)):K=3===L.type?c._findCentroid(U):[new h.Anchor(U[0].x,U[0].y)];for(T=0;T<K.length;T++){var V=K[T];0>V.x||4096<V.x||0>V.y||4096<V.y||b&&0<I&&0===n.rotationAlignment&&!c._honorsTextMaxAngle(U,V,I,y,q)||f.push({shaping:G,line:U,iconMosaicItem:S,anchor:V,iconSize:L.iconSize,iconRotate:L.iconRotate,ddIconValues:L.ddIconValues,textSize:L.textSize,textRotate:L.textRotate,
ddTextValues:L.ddTextValues})}}}f.sort(r);for(u=0;u<f.length;u++)this._processFeature(f[u],z,O,a);this._addPlacedGlyphs()};c.prototype.updateSymbols=function(){this._iconIndexStart=this._iconIndexBuffer.index;this._textIndexStart=this._textIndexBuffer.index;this._textIndexCount=this._iconIndexCount=0;this._markerMap.clear();this._glyphMap.clear();var a=this._avoidEdges,c=this.layer,b;c.getLayoutProperty("icon-image")&&(b=this._getTranslate(!0));var d;c.getLayoutProperty("text-field")&&(d=this._getTranslate(!1));
for(var c=0,e=this._symbolInstances;c<e.length;c++)this._processFeature(e[c],b,d,a);this._addPlacedGlyphs()};c.prototype._getTranslate=function(a){var c=this.layer.getPaintValue(a?"icon-translate":"text-translate",this.zoom);if(0!==c[0]||0!==c[1]){var b=this._placementEngine.mapAngle;return 0!==b&&0===this.layer.getPaintValue(a?"icon-translate-anchor":"text-translate-anchor",this.zoom)?(a=Math.sin(b),b=Math.cos(b),[8*(c[0]*b-c[1]*a),8*(c[0]*a+c[1]*b)]):[8*c[0],8*c[1]]}};c.prototype._replaceKeys=function(a,
c){return a.replace(/{([^{}]+)}/g,function(a,b){return b in c?c[b]:""})};c.prototype._processFeature=function(a,c,b,d){var h=a.line,l=a.iconMosaicItem,n=a.shaping,m=a.anchor,p=this._iconLayout,r=p&&!!l,x=!0,z=1;r&&(p.size=a.iconSize,p.rotate=a.iconRotate,z=8*p.size,x=p.optional||!l);var D=this._textLayout,q=D&&n&&0<n.length,A;A=1;var J=!0;q&&(D.size=a.textSize,D.rotate=a.textRotate,A=D.size/24,A*=8,J=D.optional||!n||0===n.length);var S=new f.Point(0,-17),G;r&&(G=this._placementEngine.getIconPlacement(m,
c,l,z,h,p,d),m.minzoom>G.footprint.minzoom&&(G.footprint.minzoom=m.minzoom),G.footprint.minzoom===e.C_INFINITY&&(G=null));if(G||x){var w;q&&(w=this._placementEngine.getTextPlacement(m,b,S,n,A,h,D,d))&&(m.minzoom>w.footprint.minzoom&&(w.footprint.minzoom=m.minzoom),w.footprint.minzoom===e.C_INFINITY&&(w=null));if(w||J)G&&w||(J||x?J||w?x||G||(w=null):G=null:w=G=null),G&&w&&!J&&!x&&(c=Math.max(G.footprint.minzoom,w.footprint.minzoom),G.footprint.minzoom=c,w.footprint.minzoom=c),w&&(D.ignorePlacement||
this._placementEngine.add(w),this._storePlacedGlyphs(w.shapes,w.footprint.minzoom,this.zoom,a.ddTextValues)),G&&(p.ignorePlacement||this._placementEngine.add(G),this._addPlacedIcons(G.shapes,G.footprint.minzoom,this.zoom,l.page,a.ddIconValues))}};c.prototype._addPlacedIcons=function(a,c,b,d,f){c=Math.max(b+e.log2(c),0);for(var h=this._iconVertexBuffer,l=this._iconIndexBuffer,n=0;n<a.length;n++){var m=a[n],p=Math.max(b+e.log2(m.minzoom),c),r=Math.min(b+e.log2(m.maxzoom),25);if(!(r<=p)){var x=m.tl,
z=m.tr,D=m.bl,q=m.br,A=m.mosaicRect,B=m.labelAngle,m=m.anchor,J=h.index,w=A.x,I=A.y,F=w+A.width,A=I+A.height;h.add(m.x,m.y,x.x,x.y,w,I,B,p,r,c,f);h.add(m.x,m.y,z.x,z.y,F,I,B,p,r,c,f);h.add(m.x,m.y,D.x,D.y,w,A,B,p,r,c,f);h.add(m.x,m.y,q.x,q.y,F,A,B,p,r,c,f);l.add(J+0,J+1,J+2);l.add(J+1,J+2,J+3);this._markerMap.has(d)?this._markerMap.get(d)[1]+=6:this._markerMap.set(d,[this._iconIndexStart+this._iconIndexCount,6]);this._iconIndexCount+=2}}};c.prototype._addPlacedGlyphs=function(){var a=this,c=this._textVertexBuffer,
b=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(d,e){for(var f=0;f<d.length;f++){var h=d[f],l=c.index;c.add(h.glyphAnchor[0],h.glyphAnchor[1],h.tl[0],h.tl[1],h.xmin,h.ymin,h.labelAngle,h.minLod,h.maxLod,h.placementLod,h.ddValues);c.add(h.glyphAnchor[0],h.glyphAnchor[1],h.tr[0],h.tr[1],h.xmax,h.ymin,h.labelAngle,h.minLod,h.maxLod,h.placementLod,h.ddValues);c.add(h.glyphAnchor[0],h.glyphAnchor[1],h.bl[0],h.bl[1],h.xmin,h.ymax,h.labelAngle,h.minLod,h.maxLod,h.placementLod,h.ddValues);
c.add(h.glyphAnchor[0],h.glyphAnchor[1],h.br[0],h.br[1],h.xmax,h.ymax,h.labelAngle,h.minLod,h.maxLod,h.placementLod,h.ddValues);b.add(l+0,l+1,l+2);b.add(l+1,l+2,l+3);a._glyphMap.has(e)?a._glyphMap.get(e)[1]+=6:a._glyphMap.set(e,[a._textIndexStart+a._textIndexCount,6]);a._textIndexCount+=2}});this._glyphBufferDataStorage.clear()};c.prototype._storePlacedGlyphs=function(a,c,b,d){c=Math.max(b+e.log2(c),0);for(var f=0;f<a.length;f++){var h=a[f],l=Math.max(b+e.log2(h.minzoom),c),n=Math.min(b+e.log2(h.maxzoom),
25);if(!(n<=l)){var m=h.tl,p=h.tr,r=h.bl,x=h.br,z=h.labelAngle,q=h.anchor,D=h.mosaicRect;this._glyphBufferDataStorage.has(h.page)||this._glyphBufferDataStorage.set(h.page,[]);this._glyphBufferDataStorage.get(h.page).push({glyphAnchor:[q.x,q.y],tl:[m.x,m.y],tr:[p.x,p.y],bl:[r.x,r.y],br:[x.x,x.y],xmin:D.x,ymin:D.y,xmax:D.x+D.width,ymax:D.y+D.height,labelAngle:z,minLod:l,maxLod:n,placementLod:c,ddValues:d})}}};c._findAnchors=function(a,c,b){c+=b;for(var d=0,l=a.length-1,n=0;n<l;n++)d+=f.Point.distance(a[n],
a[n+1]);n=.5*(b||c);if(d<=n)return[];b=n/d;c=d/Math.max(Math.round(d/c),1);for(var d=0,l=-c/2,m=[],p=a.length-1,n=0;n<p;n++){for(var r=a[n],x=a[n+1],z=x.x-r.x,q=x.y-r.y,D=Math.sqrt(z*z+q*q),A=void 0;l+c<d+D;){var l=l+c,R=(l-d)/D,L=e.interpolate(r.x,x.x,R),R=e.interpolate(r.y,x.y,R);void 0===A&&(A=Math.atan2(q,z));m.push(new h.Anchor(L,R,A,n,b))}d+=D}return m};c._deviation=function(a,c,b){return Math.atan2((c.x-a.x)*(b.y-c.y)-(c.y-a.y)*(b.x-c.x),(c.x-a.x)*(b.x-c.x)+(c.y-a.y)*(b.y-c.y))};c._honorsTextMaxAngle=
function(a,c,b,d,e){var h=0;b/=2;for(var l=new f.Point(c.x,c.y),n=c.segment+1;h>-b;){--n;if(0>n)return!1;h-=f.Point.distance(a[n],l);l=a[n]}h+=f.Point.distance(a[n],a[n+1]);c=[];for(var l=0,m=a.length;h<b;){var p=a[n],r=void 0;do{++n;if(n===m)return!1;r=a[n]}while(r.isEqual(p));var x=n,z=void 0;do{++x;if(x===m)return!1;z=a[x]}while(z.isEqual(r));p=this._deviation(p,r,z);c.push({deviation:p,distToAnchor:h});for(l+=p;h-c[0].distToAnchor>e;)l-=c.shift().deviation;if(Math.abs(l)>d)return!1;h+=f.Point.distance(r,
z)}return!0};c._smoothVertices=function(a,c){if(!(0>=c)){var b=a.length;if(!(3>b)){var d=[],e=0;d.push(0);for(var h=1;h<b;h++)e+=f.Point.distance(a[h],a[h-1]),d.push(e);c=Math.min(c,.2*e);e=[];e.push(a[0].x);e.push(a[0].y);var l=a[b-1].x,m=a[b-1].y,h=f.Point.sub(a[0],a[1]);h.normalize();a[0].x+=c*h.x;a[0].y+=c*h.y;h.assignSub(a[b-1],a[b-2]);h.normalize();a[b-1].x+=c*h.x;a[b-1].y+=c*h.y;for(h=1;h<b;h++)d[h]+=c;d[b-1]+=c;for(var n=.5*c,h=1;h<b-1;h++){for(var p=0,r=0,z=0,q=h-1;0<=q&&!(d[q+1]<d[h]-n);q--){var A=
n+d[q+1]-d[h],D=d[q+1]-d[q],L=d[h]-d[q]<n?1:A/D;if(1E-6>Math.abs(L))break;var S=L*L,G=L*A-.5*S*D,w=L*D/c,I=a[q+1],F=a[q].x-I.x,U=a[q].y-I.y,p=p+w/G*(I.x*L*A+.5*S*(A*F-D*I.x)-S*L*D*F/3),r=r+w/G*(I.y*L*A+.5*S*(A*U-D*I.y)-S*L*D*U/3),z=z+w}for(q=h+1;q<b&&!(d[q-1]>d[h]+n);q++){A=n-d[q-1]+d[h];D=d[q]-d[q-1];L=d[q]-d[h]<n?1:A/D;if(1E-6>Math.abs(L))break;S=L*L;G=L*A-.5*S*D;w=L*D/c;I=a[q-1];F=a[q].x-I.x;U=a[q].y-I.y;p+=w/G*(I.x*L*A+.5*S*(A*F-D*I.x)-S*L*D*F/3);r+=w/G*(I.y*L*A+.5*S*(A*U-D*I.y)-S*L*D*U/3);z+=
w}e.push(p/z);e.push(r/z)}e.push(l);e.push(m);for(q=h=0;h<b;h++)a[h].x=e[q++],a[h].y=e[q++]}}};c._findCentroid=function(a){var c=a.length-1,b=0,d=0,e=0,f=a[0].x,l=a[0].y;4096<f&&(f=4096);0>f&&(f=0);4096<l&&(l=4096);0>l&&(l=0);for(var m=1;m<c;m++){var p=a[m].x,r=a[m].y,q=a[m+1].x,z=a[m+1].y;4096<p&&(p=4096);0>p&&(p=0);4096<r&&(r=4096);0>r&&(r=0);4096<q&&(q=4096);0>q&&(q=0);4096<z&&(z=4096);0>z&&(z=0);var A=(p-f)*(z-l)-(q-f)*(r-l),b=b+A*(f+p+q),d=d+A*(l+r+z),e=e+A}b/=3*e;d/=3*e;return isNaN(b)||isNaN(d)?
[]:[new h.Anchor(b,d)]};c._bidiEngine=new m;return c}(c)})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/Stateful"],function(q,a,b){function p(a,b,d,e,h){var g=a;void 0===b&&(b=h.defInFormat);void 0===d&&(d=h.defOutFormat);void 0===e&&(e=h.defSwap);if(b!==d){var k,l=b.substring(0,1);k=b.substring(1,4);var n=d.substring(0,1),r=d.substring(1,4);"C"===k.charAt(0)&&(k=m(g),k="ltr"===k||"rtl"===k?k.toUpperCase():"L"===b.charAt(2)?"LTR":"RTL",b=l+k);"C"===r.charAt(0)&&
(k=m(g),"rtl"===k?r="RTL":"ltr"===k?(g=g.split(""),g.reverse(),k=m(g.join("")),r=k.toUpperCase()):r="L"===d.charAt(2)?"LTR":"RTL",d=n+r)}if(b===d)return a;n=b.substring(0,1);g=b.substring(1,4);l=d.substring(0,1);r=d.substring(1,4);h.inFormat=b;h.outFormat=d;h.swap=e;if("L"===n&&"VLTR"===d){if("LTR"===g)return h.dir=E,f(a,h);if("RTL"===g)return h.dir=H,f(a,h)}if("V"===n&&"V"===l)return h.dir="RTL"===g?H:E,c(a,h);if("L"===n&&"VRTL"===d)return h.dir="LTR"===g?E:H,a=f(a,h),c(a);if("VLTR"===b&&"LLTR"===
d)return h.dir=E,f(a,h);if("V"===n&&"L"===l&&g!==r)return a=c(a),"RTL"===g?p(a,"LLTR","VLTR",e,h):p(a,"LRTL","VRTL",e,h);if("VRTL"===b&&"LRTL"===d)return p(a,"LRTL","VRTL",e,h);if("L"===n&&"L"===l)return b=h.swap,h.swap=b.substr(0,1)+"N","RTL"===g?(h.dir=H,a=f(a,h),h.swap="N"+b.substr(1,2),h.dir=E,a=f(a,h)):(h.dir=E,a=f(a,h),h.swap="N"+b.substr(1,2),a=p(a,"VLTR","LRTL",h.swap,h)),a}function m(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?
"ltr":"rtl":""}function f(a,c){a=a.split("");var b=[];l(a,b,c);if(0!==c.hiLevel&&c.swap.substr(0,1)!==c.swap.substr(1,2))for(var e=0;e<a.length;e++)if(1===b[e]){var h=e,f;b:{f=a[e];for(var g=void 0,k=0,n=Q.length-1;k<=n;)if(g=Math.floor((k+n)/2),f<Q[g][0])n=g-1;else if(f>Q[g][0])k=g+1;else{f=Q[g][1];break b}}a[h]=f}d(2,a,b,c);d(1,a,b,c);C=b;return a.join("")}function l(a,c,b){var d=a.length,e=b.dir?ga:Y,h=null,f=null,g=null,h=0,f=f=null,k=-1,l=f=null,n=[],m=[];b.hiLevel=b.dir;b.lastArabic=!1;b.hasUbatAl=
!1;b.hasUbatB=!1;b.hasUbatS=!1;for(f=0;f<d;f++){var l=f,g=a[f].charCodeAt(0),p=qa[g>>8];n[l]=p<da?p:ra[p-da][g&255]}for(l=0;l<d;l++){m[l]=f=r(a,n,m,l,b);h=e[h][f];f=h&240;h&=15;c[l]=g=e[h][v];if(0<f){if(16===f)for(f=k;f<l;f++)c[f]=1;k=-1}if(f=e[h][u])-1===k&&(k=l);else if(-1<k){for(f=k;f<l;f++)c[f]=g;k=-1}n[l]===aa&&(c[l]=0);b.hiLevel|=g}if(b.hasUbatS)for(a=0;a<d;a++)if(n[a]===ka)for(c[a]=b.dir,e=a-1;0<=e;e--)if(n[e]===ma)c[e]=b.dir;else break}function c(a,c){a=a.split("");if(c){var b=[];l(a,b,c);
C=b}a.reverse();J.reverse();return a.join("")}function e(a){for(var c=0;c<V.length;c++)if(a>=V[c]&&a<=Z[c])return!0;return!1}function h(a,c,b,d){for(;c*b<d&&A(a[c]);)c+=b;return c*b<d&&e(a[c])?!0:!1}function d(a,c,b,d){if(!(d.hiLevel<a))if(1!==a||d.dir!==H||d.hasUbatB){d=c.length;for(var e=0,h,f,g;e<d;){if(b[e]>=a){for(h=e+1;h<d&&b[h]>=a;)h++;for(f=h-1;e<f;e++,f--)g=c[e],c[e]=c[f],c[f]=g,g=J[e],J[e]=J[f],J[f]=g;e=h}e++}}else c.reverse(),J.reverse()}function r(a,c,b,d,e){return{UBAT_L:function(){e.lastArabic=
!1;return ba},UBAT_R:function(){e.lastArabic=!1;return fa},UBAT_ON:function(){return X},UBAT_AN:function(){return ha},UBAT_EN:function(){return e.lastArabic?ha:ca},UBAT_AL:function(){e.lastArabic=!0;e.hasUbatAl=!0;return fa},UBAT_WS:function(){return X},UBAT_CS:function(){var a,h;if(1>d||d+1>=c.length||(a=b[d-1])!==ca&&a!==ha||(h=c[d+1])!==ca&&h!==ha)return X;e.lastArabic&&(h=ha);return h===a?h:X},UBAT_ES:function(){return(0<d?b[d-1]:aa)===ca&&d+1<c.length&&c[d+1]===ca?ca:X},UBAT_ET:function(){if(0<
d&&b[d-1]===ca)return ca;if(e.lastArabic)return X;for(var a=d+1,h=c.length;a<h&&c[a]===na;)a++;return a<h&&c[a]===ca?ca:X},UBAT_NSM:function(){if("VLTR"===e.inFormat){for(var h=c.length,f=d+1;f<h&&c[f]===ja;)f++;if(f<h&&(h=a[d],f=c[f],(1425<=h&&2303>=h||64286===h)&&(f===fa||f===la)))return fa}return 1>d||c[d-1]===aa?X:b[d-1]},UBAT_B:function(){e.lastArabic=!0;e.hasUbatB=!0;return e.dir},UBAT_S:function(){e.hasUbatS=!0;return X},UBAT_LRE:function(){e.lastArabic=!1;return X},UBAT_RLE:function(){e.lastArabic=
!1;return X},UBAT_LRO:function(){e.lastArabic=!1;return X},UBAT_RLO:function(){e.lastArabic=!1;return X},UBAT_PDF:function(){e.lastArabic=!1;return X},UBAT_BN:function(){return X}}[oa[c[d]]]()}function z(a,c){for(var b=0;b<G.length;b++)if(a===G[b])return c[b];return a}function A(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function D(a){if("L"===a)return"LTR";if("R"===a)return"RTL";if("C"===a)return"CLR";if("D"===a)return"CRL"}function n(a,c){for(var b=0;b<R.length;b++)if(a===R[b])return c[b];return a}
function x(a,c,b,d){for(var e=0;e<a.length;e++)if(a[e]>c||!b&&a[e]===c)a[e]+=d}q.getObject("string",!0,dojox);q=a("dojox.string.BidiEngine",b,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(a,c,b){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var d=this.sourceToTarget,f=this.targetToSource,g=a.length;J=[];C=[];for(var k=0;k<g;k++)d[k]=k,f[k]=k,J[k]=k;if(!this.checkParameters(c,b))return a;c=this.inputFormat;b=this.outputFormat;
var d=a,d=y,k=D(c.charAt(1)),f=D(b.charAt(1)),l="I"===c.charAt(0)?"L":c.charAt(0),g="I"===b.charAt(0)?"L":b.charAt(0),k=l+k,f=g+f,g=c.charAt(2)+b.charAt(2);d.defInFormat=k;d.defOutFormat=f;d.defSwap=g;a=p(a,k,f,g,d);d=!1;if("R"===b.charAt(1))d=!0;else if("C"===b.charAt(1)||"D"===b.charAt(1))d=this.checkContextual(a);f=this.sourceToTarget=J;g=Array(f.length);for(k=0;k<f.length;k++)g[f[k]]=k;B=this.targetToSource=g;if(c.charAt(3)===b.charAt(3))d=a;else if("S"===b.charAt(3))if(c=d,b=!0,0===a.length)d=
void 0;else{void 0===c&&(c=!0);void 0===b&&(b=!0);a=String(a);a=a.split("");var m=0,f=1,d=a.length;c||(m=a.length-1,f=-1,d=1);for(var g=d,k=b,r=0,d=[],l=0;m*f<g;m+=f)if(e(a[m])||A(a[m])){var q;if(q="\u0644"===a[m])b:{for(var t=a,u=m+f,v=f,E=g;u*v<E&&A(t[u]);)u+=v;q=" ";if(u*v<E)for(q=t[u],t=0;t<R.length;t++)if(R[t]===q){q=!0;break b}q=!1}if(q){a[m]=0===r?n(a[m+f],L):n(a[m+f],S);m+=f;r=a;q=m;t=f;for(u=g;q*t<u&&A(r[q]);)q+=t;q*t<u&&(r[q]=" ");k&&(d[l]=m,l++);r=0}else{q=a[m];if(1===r){t=m;if(h(a,m+f,
f,g))b:for(u=a[m],v=0;v<G.length;v++){if(u===G[v]){u=F[v];break b}}else u=z(a[m],I);a[t]=u}else!0===h(a,m+f,f,g)?a[m]=z(a[m],U):a[m]=z(a[m],w);A(q)||(r=1);b:{for(t=0;t<T.length;t++)if(T[t]===q){q=!0;break b}q=!1}!0===q&&(r=0)}}else r=0;f="";for(g=0;g<a.length;g++){if(k=b){b:{for(k=0;k<d.length;k++)if(d[k]===g)break b;k=-1}k=-1<k}k?(x(B,g,!c,-1),J.splice(g,1)):f+=a[g]}d=f}else if(c=a,b=d,a=!0,0===c.length)d=void 0;else for(void 0===a&&(a=!0),void 0===b&&(b=!0),c=String(c),d="",f=[],f=c.split(""),g=
0;g<c.length;g++)k=!1,"\ufe70"<=f[g]&&"\ufeff">f[g]?(l=c.charCodeAt(g),"\ufef5"<=f[g]&&"\ufefc">=f[g]?(b?(0<g&&a&&" "===f[g-1]?d=d.substring(0,d.length-1)+"\u0644":(d+="\u0644",k=!0),d+=R[(l-65269)/2]):(d+=R[(l-65269)/2],d+="\u0644",g+1<c.length&&a&&" "===f[g+1]?g++:k=!0),k&&(x(B,g,!0,1),J.splice(g,0,J[g]))):d+=K[l-65136]):d+=f[g];this.sourceToTarget=J;this.targetToSource=B;this.levels=C;return d},_inputFormatSetter:function(a){if(!P.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=a},_outputFormatSetter:function(a){if(!P.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a},checkParameters:function(a,c){a?this.set("inputFormat",a):a=this.inputFormat;c?this.set("outputFormat",c):c=this.outputFormat;return a===c?!1:!0},checkContextual:function(a){a=m(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(sa){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a},hasBidiChar:function(a){return O.test(a)}});var J=
[],B=[],C=[],y={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},v=5,u=6,E=0,H=1,P=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,O=/[\u0591-\u06ff\ufb1d-\ufefc]/,Q=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],
["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],R=["\u0622","\u0623","\u0625","\u0627"],L=["\ufef5","\ufef7","\ufef9","\ufefb"],S=["\ufef6","\ufef8","\ufefa","\ufefc"],G="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),
w="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),I="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),
F="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),U="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),
T="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),K="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
V=["\u0621","\u0641"],Z=["\u063a","\u064a"],Y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ga=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],ba=0,fa=1,ca=2,ha=3,X=4,aa=5,ka=6,la=7,ma=8,na=11,ja=12,oa="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),da=100;a=ba;b=fa;var M=ca,W=ha,g=X,ia=aa,pa=ka,k=la,ea=ma,
N=na,t=ja,qa=[da+0,a,a,a,a,da+1,da+2,da+3,b,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,da+4,g,g,g,a,g,a,g,a,g,g,g,a,a,g,g,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,g,g,a,a,g,g,a,a,g,g,g,g,g,g,g,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,da+5,k,k,da+6,da+7],ra=[[18,18,18,18,18,18,18,18,18,pa,ia,pa,ea,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,ia,ia,ia,pa,ea,g,g,N,N,N,g,g,g,g,g,10,9,10,9,9,M,M,M,M,M,M,M,M,M,M,9,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,18,18,18,18,18,18,ia,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,g,N,N,N,N,g,g,g,g,a,g,g,18,g,g,N,N,M,M,g,a,g,g,g,M,a,g,g,
g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,a,a,a,a,a,a,a,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,a,g,g,g,g,g,g,g,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,
t,t,t,t,t,t,t,b,t,b,t,t,b,t,t,b,t,g,g,g,g,g,g,g,g,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,g,g,g,g,g,b,b,b,b,b,g,g,g,g,g,g,g,g,g,g,g],[W,W,W,W,g,g,g,g,k,N,N,k,9,k,g,g,t,t,t,t,t,t,t,t,t,t,t,k,g,g,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,W,W,W,W,W,W,W,W,W,W,N,W,W,k,k,k,t,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,
k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,t,t,t,t,t,t,t,W,g,t,t,t,t,t,t,k,k,t,t,g,t,t,t,t,k,k,M,M,M,M,M,M,M,M,M,M,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,g,k,k,t,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,g,g,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,t,t,t,t,t,
t,t,t,t,t,t,k,g,g,g,g,g,g,g,g,g,g,g,g,g,g,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,t,t,t,t,t,t,t,t,t,b,b,g,g,g,g,b,g,g,g,g,g],[ea,ea,ea,ea,ea,ea,ea,ea,ea,ea,ea,18,18,18,a,b,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,ea,ia,13,14,15,16,17,9,N,N,N,N,N,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,9,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,ea,18,18,18,18,18,g,g,g,g,g,18,18,18,18,18,18,M,a,g,g,M,M,M,M,M,M,10,10,g,g,g,a,M,M,M,M,M,M,M,M,M,M,10,10,g,g,g,g,a,a,
a,a,a,a,a,a,a,a,a,a,a,g,g,g,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,g,g,g,g,g,b,t,b,b,b,b,b,b,b,b,b,b,10,b,b,b,b,b,b,b,b,b,b,b,b,b,g,b,b,b,b,b,g,b,g,b,b,g,b,b,g,b,b,b,b,b,b,b,b,b,b,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,
k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,t,t,t,t,t,t,t,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,9,g,9,g,g,9,g,g,g,g,g,g,g,g,g,N,g,g,10,10,g,g,g,g,g,N,N,g,g,g,g,g,k,k,k,k,k,g,k,k,k,k,k,k,k,k,k,k,k,k,k,k,
k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,g,g,18],[g,g,g,N,N,N,g,g,g,g,g,10,9,10,9,9,M,M,M,M,M,M,M,M,M,M,9,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,a,a,a,a,a,a,g,g,a,a,a,a,a,a,g,g,a,a,a,a,a,a,g,g,a,a,a,g,g,g,N,N,g,g,g,N,N,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g]];return q})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(q,a,b,p){return q("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;return b[a]?
b[a]:b[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,b){return"function"===typeof this[b.g]?this[b.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,b){if("object"===typeof a){for(var f in a)a.hasOwnProperty(f)&&"_watchCallbacks"!=f&&this.set(f,a[f]);return this}f=this._getAttrNames(a);var c=this._get(a,f);f=this[f.s];var e;"function"===typeof f?e=f.apply(this,Array.prototype.slice.call(arguments,1)):this[a]=b;
if(this._watchCallbacks){var h=this;p(e,function(){h._watchCallbacks(a,c,b)})}return this},_changeAttrValue:function(a,b){var f=this.get(a);this[a]=b;this._watchCallbacks&&this._watchCallbacks(a,f,b);return this},watch:function(a,f){var l=this._watchCallbacks;if(!l)var c=this,l=this._watchCallbacks=function(a,b,e,f){var d=function(d){if(d){d=d.slice();for(var h=0,f=d.length;h<f;h++)d[h].call(c,a,b,e)}};d(l["_"+a]);f||d(l["*"])};f||"function"!==typeof a?a="_"+a:(f=a,a="*");var e=l[a];"object"!==typeof e&&
(e=l[a]=[]);e.push(f);a={};a.unwatch=a.remove=function(){var a=b.indexOf(e,f);-1<a&&e.splice(a,1)};return a}})})},"esri/views/2d/engine/webgl/TextShaping":function(){define(["require","exports"],function(q,a){return function(){function a(a,b,f,l,c,e,h,d){this._glyphItems=a;this._maxWidth=b;this._lineHeight=f;this._letterSpacing=l;this._offset=c;this._hAnchor=e;this._vAnchor=h;this._justify=d}a.prototype.getShaping=function(a,b){for(var f=this._letterSpacing,l=this._lineHeight,c=this._justify,e=this._maxWidth,
h=[],d=0,m=0,p=0,q=0,D=-1,n=0,x=-1,J=a.length,B=0;B<J;B++){var C=a.charCodeAt(B);if(10===C){if(B!==J-1){if(D>=q){var d=h[D],y=d.x+d.glyphMosaicItem.metrics.advance,n=Math.max(y,n);c&&this._applyJustification(h,q,D);q=h.length}m=b?m-l:m+l;d=0;++p}}else{for(var y=void 0,v=0,u=this._glyphItems;v<u.length&&!(y=u[v][C]);v++);if(y){h.push({codePoint:C,x:d,y:m,glyphMosaicItem:y});d+=y.metrics.advance+f;if(0<e&&d>e&&0<=x){v=x+1;y=h[v].x;n=Math.max(y,n);for(u=v;u<h.length;u++)h[u].y=b?h[u].y-l:h[u].y+l,h[u].x-=
y;c&&this._applyJustification(h,q,x);m=b?m-l:m+l;d-=y;++p;q=v;x=-1}++D;32===C&&(x=h.length-1)}}}D>=q&&(d=h[D],n=Math.max(n,d.x+d.glyphMosaicItem.metrics.advance),c&&this._applyJustification(h,q,D));if(0<h.length)for(a=(c-this._hAnchor)*n,f=(-this._vAnchor*(p+1)+.5)*l,b&&p&&(f+=p*l),a+=this._offset[0],f+=this._offset[1],b=0;b<h.length;b++)l=h[b],l.x+=a,l.y+=f;return h};a.getBox=function(a,b){var f=a.length;if(0!==f){for(var l=a[0].x,c=l,e=a[0].y,h=e,d=e,m=1;m<f;m++){var p=a[m],q=p.x;q<l&&(l=q);q>c&&
(c=q);p=p.y;p<e&&(e=p);p>h&&(h=p);p!==d&&(d=this._glyphWidth(a[m-1].codePoint,b),c=Math.max(c,a[m-1].x+d),d=p)}b=this._glyphWidth(a[f-1].codePoint,b);c=Math.max(c,a[f-1].x+b);e+=17;return{x:l,y:e,width:c-l,height:h+7-e}}};a.prototype._applyJustification=function(a,b,f){for(var l=a[f],l=(l.x+l.glyphMosaicItem.metrics.advance)*this._justify;b<=f;b++)a[b].x-=l};a._glyphWidth=function(a,b){for(var f,l=0;l<b.length&&!(f=b[l][a]);l++);return f?f.metrics.advance:0};return a}()})},"esri/views/vectorTiles/TileParser":function(){define("require exports dojo/promise/all ../../core/executeAsync ../../core/pbf ../../core/promiseUtils ../2d/engine/webgl/TileClipper ./BackgroundBucket ./CircleBucket ./Feature ./FillBucket ./LineBucket ./SourceLayerData ./SymbolBucket".split(" "),
function(q,a,b,p,m,f,l,c,e,h,d,r,z,A){return function(){function a(a,c,b){this._pbfTile=new m(new Uint8Array(a),new DataView(a));this._tile=c;this._connection=b;this._layers=c.getLayers();b=c.tileKey.split("/").map(parseFloat);var d=b[0];a=b[1];b=b[2];this._level=d;c.refKey&&(c=c.refKey.split("/").map(parseFloat)[0],c=d-c,0<c&&(d=(1<<c)-1,this._tileClipper=new l.TileClipper(c,a&d,b&d)));this._tileClipper||(this._tileClipper=new l.SimpleBuilder)}a.prototype.parse=function(){for(var a=this,c=this._parseTileData(this._pbfTile),
d=this._layers,e=d.length,l=this._level,m,r=[],q={},z=new Set,e=e-1;0<=e;e--)if(m=d[e],!(m.minzoom&&l<m.minzoom||m.maxzoom&&l>=m.maxzoom||m.layout&&"none"===m.layout.visibility))if(0===m.type)m=this._createBucket(m),m.layerIndex=e,r.push(m);else{var A=m.sourceLayer,D=c[A];D&&(z.add(A),m=this._createBucket(m))&&(m.layerIndex=e,m.layerExtent=D.extent,(D=q[A])||(D=q[A]=[]),D.push(m))}var O=10*this._level,Q=10*(this._level+1),R=[],L=[],S=[],G=[],w=this._tileClipper,I=new Set,F={},U=[];z.forEach(function(a){return U.push(a)});
var T=0,K=0,V=U.length;return p(function(){if(6===a._tile.status)return!0;switch(T){case 0:if(K<V){var b=U[K++],d=c[b],e=q[b];if(e&&0!==e.length)for(b=d.getData();b.next(2);){var f=new h(b.getMessage(),d),l=f.values;if(l){var m=l._minzoom;if(m&&m>=Q)continue;if((l=l._maxzoom)&&l<=O)continue}for(var m=0,n=e;m<n.length;m++)l=n[m],l.pushFeature(f)}}else{d=a._tile;for(b in q)for(e=q[b],f=0;f<e.length;f++)l=e[f],l.hasFeatures()&&(3===l.layer.type?(R.push(l),d.addBucket(l)):l.layer.refLayerId?S.push(l):
(L.push(l),G[l.layer.id]=l));T=1;K=0;V=R.length}break;case 1:K<V?R[K++].getResources(w,I,F):T=2}return 2===T}).then(function(){if(6===a._tile.status)return[];var c=[],d=a._tile.getWorkerTileHandler(),e;0<I.size&&(e=d.fetchSprites(I,a._connection),c.push(e));for(var h in F)e=F[h],0<e.size&&(e=d.fetchGlyphs(a._tile.tileKey,h,e,a._connection),c.push(e));return b(c).then(function(c){if(6===a._tile.status)return[];var b=0,d=0,e=L.length;return p(function(){if(6===a._tile.status)return!0;switch(b){case 0:if(d<
e){var c=L[d++];c.processFeatures(w,a._tile);r.push(c)}else b=1,d=0,e=S.length;break;case 1:for(var f=0;f<S.length;f++){var c=S[f],h=G[c.layer.refLayerId];h&&(h.assignBufferInfo(c),r.push(c))}b=2;d=0;e=R.length;break;case 2:d<e?(c=R[d++],c.processFeatures(w,a._tile),r.push(c)):b=3}return 3===b}).then(function(){r.sort(function(a,c){return a.layerIndex-c.layerIndex});return r})}).catch(function(a){return f.reject(Error(a))})}).catch(function(a){return f.reject(Error(a))})};a.prototype._parseTileData=
function(a){for(var c={};a.next();)switch(a.tag()){case 3:var b=new z(a.getMessage());c[b.name]=b;break;default:a.skip()}return c};a.prototype._createBucket=function(a){switch(a.type){case 0:return this._createBackgroundBucket(a);case 1:return this._createFillBucket(a);case 2:return this._createLineBucket(a);case 4:return this._createCircleBucket(a);case 3:return this._createSymbolBucket(a)}};a.prototype._createBackgroundBucket=function(a){return new c(a,this._level)};a.prototype._createFillBucket=
function(a){var c=this._tile;return new d(a,this._level,a.hasDataDrivenFill?c.fillDDVertexBuffer:c.fillVertexBuffer,c.fillIndexBuffer,a.hasDataDrivenOutline?c.outlineDDVertexBuffer:c.outlineVertexBuffer,c.outlineIndexBuffer)};a.prototype._createLineBucket=function(a){var c=this._tile;return new r(a,this._level,a.hasDataDrivenLine?c.lineDDVertexBuffer:c.lineVertexBuffer,c.lineIndexBuffer)};a.prototype._createCircleBucket=function(a){var c=this._tile;return new e(a,this._level,c.circleVertexBuffer,
c.circleIndexBuffer)};a.prototype._createSymbolBucket=function(a){var c=this._tile;return new A(a,this._level,a.hasDataDrivenIcon?c.iconDDVertexBuffer:c.iconVertexBuffer,c.iconIndexBuffer,a.hasDataDrivenText?c.textDDVertexBuffer:c.textVertexBuffer,c.textIndexBuffer,c.placementEngine,c.getWorkerTileHandler())};return a}()})},"esri/core/pbf":function(){define(["require","exports"],function(q,a){return function(){function a(a,b,f,l){this._tag=0;this._dataType=99;this._data=a;this._dataView=b;this._pos=
f||0;this._end=l||a.byteLength}a.prototype.clone=function(){return new a(this._data,this._dataView,this._pos,this._end)};a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var b=this._decodeVarint();this._tag=b>>3;this._dataType=b&7;if(!a||a===this._tag)break;this.skip()}return!0};a.prototype.empty=function(){return this._pos>=this._end};a.prototype.tag=function(){return this._tag};a.prototype.getInt32=function(){return this._decodeVarint()};a.prototype.getInt64=function(){return this._decodeVarint()};
a.prototype.getUInt32=function(){var a=4294967295,a=(this._data[this._pos]&127)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&127)<<7)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&127)<<14)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&127)<<21)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&15)<<28)>>>0;if(128>this._data[this._pos++])return a};a.prototype.getUInt64=function(){return this._decodeVarint()};
a.prototype.getSInt32=function(){var a=this.getUInt32();return a>>>1^-(a&1)|0};a.prototype.getSInt64=function(){return this._decodeSVarint()};a.prototype.getBool=function(){var a=0!==this._data[this._pos];this._skip(1);return a};a.prototype.getEnum=function(){return this._decodeVarint()};a.prototype.getFixed64=function(){var a=this._dataView,b=this._pos,a=a.getUint32(b,!0)+4294967296*a.getUint32(b+4,!0);this._skip(8);return a};a.prototype.getSFixed64=function(){var a=this._dataView,b=this._pos,a=
a.getUint32(b,!0)+4294967296*a.getInt32(b+4,!0);this._skip(8);return a};a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);this._skip(8);return a};a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);this._skip(4);return a};a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);this._skip(4);return a};a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};a.prototype.getString=
function(){var a=this._getLength(),b=this._pos,b=this._toString(this._data,b,b+a);this._skip(a);return b};a.prototype.getBytes=function(){var a=this._getLength(),b=this._pos,b=this._toBytes(this._data,b,b+a);this._skip(a);return b};a.prototype.getMessage=function(){var b=this._getLength(),m=this._pos,m=new a(this._data,this._dataView,m,m+b);this._skip(b);return m};a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());
break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a};a.prototype._decodeVarint=function(){var a=this._data,b=this._pos,f=0,l;if(10<=this._end-b){if(l=a[b++],f|=l&127,0!==(l&128)&&(l=a[b++],f|=(l&127)<<7,0!==(l&128)&&(l=a[b++],f|=(l&127)<<14,0!==(l&128)&&(l=a[b++],f|=(l&127)<<21,0!==(l&128)&&(l=a[b++],f+=268435456*(l&127),0!==(l&128)&&(l=a[b++],f+=34359738368*
(l&127),0!==(l&128)&&(l=a[b++],f+=4398046511104*(l&127),0!==(l&128)&&(l=a[b++],f+=562949953421312*(l&127),0!==(l&128)&&(l=a[b++],f+=72057594037927936*(l&127),0!==(l&128)&&(l=a[b++],f+=0x7fffffffffffffff*(l&127),0!==(l&128)))))))))))throw Error("Varint too long!");}else{for(var c=1;b!==this._end;){l=a[b];if(0===(l&128))break;++b;f+=(l&127)*c;c*=128}if(b===this._end)throw Error("Varint overrun!");++b;f+=l*c}this._pos=b;return f};a.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%
2?-(a+1)/2:a/2};a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};a.prototype._toString=function(a,b,f){var l="",c="";for(f=Math.min(this._end,f);b<f;++b){var e=a[b];e&128?c+="%"+e.toString(16):(l+=decodeURIComponent(c)+String.fromCharCode(e),c="")}c.length&&(l+=decodeURIComponent(c));return l};a.prototype._toBytes=function(a,b,f){f=Math.min(this._end,f);return new Uint8Array(a.buffer,b,f-b)};return a}()})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require",
"exports","./Geometry","./GeometryUtils"],function(q,a,b,p){Object.defineProperty(a,"__esModule",{value:!0});var m=function(){return function(a,c,b){this.ratio=a;this.x=c;this.y=b}}();q=function(){function a(a,b,f,d,l){void 0===d&&(d=8);void 0===l&&(l=8);this.lines=[];this.starts=[];this.pixelRatio=d;this.pixelMargin=l;this.tileSize=512*d;this.dz=a;this.yPos=b;this.xPos=f}a.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var c=this.pixelRatio*this.pixelMargin,c=c/this.finalRatio;
a>>=this.dz;c>a&&(c=a);this.margin=c;this.xmin=a*this.xPos-c;this.ymin=a*this.yPos-c;this.xmax=this.xmin+a+2*c;this.ymax=this.ymin+a+2*c};a.prototype.reset=function(a){this.type=a;this.lines=[];this.starts=[];this.line=null;this.start=0};a.prototype.moveTo=function(a,e){this._pushLine();this._prevIsIn=this._isIn(a,e);this._moveTo(a,e,this._prevIsIn);this._prevPt=new b.Point(a,e);this._firstPt=new b.Point(a,e);this._dist=0};a.prototype.lineTo=function(a,e){var c=this._isIn(a,e),d=new b.Point(a,e),
f=b.Point.distance(this._prevPt,d),l,p,q;if(c)this._prevIsIn?this._lineTo(a,e,!0):(l=this._prevPt,p=d,a=this._intersect(p,l),this.start=this._dist+f*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(p.x,p.y,!0));else if(this._prevIsIn)p=this._prevPt,l=d,a=this._intersect(p,l),this._lineTo(a.x,a.y,!0),this._lineTo(l.x,l.y,!1);else{var n=this._prevPt;if(!(n.x<=this.xmin&&d.x<=this.xmin||n.x>=this.xmax&&d.x>=this.xmax||n.y<=this.ymin&&d.y<=this.ymin||n.y>=this.ymax&&d.y>=this.ymax)){a=[];if(n.x<this.xmin&&
d.x>this.xmin||n.x>this.xmin&&d.x<this.xmin)e=(this.xmin-n.x)/(d.x-n.x),q=n.y+e*(d.y-n.y),q<=this.ymin?p=!1:q>=this.ymax?p=!0:a.push(new m(e,this.xmin,q));if(n.x<this.xmax&&d.x>this.xmax||n.x>this.xmax&&d.x<this.xmax)e=(this.xmax-n.x)/(d.x-n.x),q=n.y+e*(d.y-n.y),q<=this.ymin?p=!1:q>=this.ymax?p=!0:a.push(new m(e,this.xmax,q));if(n.y<this.ymin&&d.y>this.ymin||n.y>this.ymin&&d.y<this.ymin)e=(this.ymin-n.y)/(d.y-n.y),q=n.x+e*(d.x-n.x),q<=this.xmin?l=!1:q>=this.xmax?l=!0:a.push(new m(e,q,this.ymin));
if(n.y<this.ymax&&d.y>this.ymax||n.y>this.ymax&&d.y<this.ymax)e=(this.ymax-n.y)/(d.y-n.y),q=n.x+e*(d.x-n.x),q<=this.xmin?l=!1:q>=this.xmax?l=!0:a.push(new m(e,q,this.ymax));if(0===a.length)l?p?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):p?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<a.length&&a[0].ratio>a[1].ratio)this.start=this._dist+f*a[1].ratio,this._lineTo(a[1].x,a[1].y,!0),this._lineTo(a[0].x,a[0].y,!0);else for(this.start=
this._dist+f*a[0].ratio,l=0;l<a.length;l++)this._lineTo(a[l].x,a[l].y,!0)}this._lineTo(d.x,d.y,!1)}this._dist+=f;this._prevIsIn=c;this._prevPt=d};a.prototype.close=function(){var a,b;0<this.line.length&&(a=this._firstPt,b=this._prevPt,a.x===b.x&&a.y===b.y||this.lineTo(a.x,a.y),a=this.line,b=a.length,4<=b&&(a[0].x===a[1].x&&a[0].x===a[b-2].x||a[0].y===a[1].y&&a[0].y===a[b-2].y)&&(a.pop(),a[0].x=a[b-2].x,a[0].y=a[b-2].y))};a.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;
3===this.type&&a&&f.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};a.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,b=a.length;if(0===b)return null;for(var f=[],d=0;d<b;d++)f.push({line:a[d],start:this.starts[d]||0});return f};a.prototype._isIn=function(a,b){return a>=this.xmin&&a<=this.xmax&&b>=this.ymin&&b<=this.ymax};a.prototype._intersect=function(a,e){var c,d,f;if(e.x>=this.xmin&&
e.x<=this.xmax)d=e.y<=this.ymin?this.ymin:this.ymax,f=(d-a.y)/(e.y-a.y),c=a.x+f*(e.x-a.x);else if(e.y>=this.ymin&&e.y<=this.ymax)c=e.x<=this.xmin?this.xmin:this.xmax,f=(c-a.x)/(e.x-a.x),d=a.y+f*(e.y-a.y);else{d=e.y<=this.ymin?this.ymin:this.ymax;c=e.x<=this.xmin?this.xmin:this.xmax;var l=(c-a.x)/(e.x-a.x),m=(d-a.y)/(e.y-a.y);l<m?(f=l,d=a.y+l*(e.y-a.y)):(f=m,c=a.x+m*(e.x-a.x))}this._r=f;return new b.Point(c,d)};a.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),
this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};a.prototype._moveTo=function(a,e,f){3!==this.type?f&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),e=Math.round((e-(this.ymin+this.margin))*this.finalRatio),this.line.push(new b.Point(a,e))):(f||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),
e<this.ymin&&(e=this.ymin),e>this.ymax&&(e=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),e=Math.round((e-(this.ymin+this.margin))*this.finalRatio),this.line.push(new b.Point(a,e)),this._is_v=this._is_h=!1)};a.prototype._lineTo=function(a,e,f){if(3!==this.type)if(f){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);e=Math.round((e-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(f=this.line[this.line.length-1],f.equals(a,e)))return;this.line.push(new b.Point(a,
e))}else this.line&&0<this.line.length&&this._pushLine();else if(f||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),e<this.ymin&&(e=this.ymin),e>this.ymax&&(e=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),e=Math.round((e-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){f=this.line[this.line.length-1];var c=f.x===a,h=f.y===e;c&&h||(this._is_h&&c?(f.x=a,f.y=e,f=this.line[this.line.length-2],this._is_h=f.x===a,this._is_v=f.y===e):this._is_v&&h?(f.x=
a,f.y=e,f=this.line[this.line.length-2],this._is_h=f.x===a,this._is_v=f.y===e):(this.line.push(new b.Point(a,e)),this._is_h=c,this._is_v=h))}else this.line.push(new b.Point(a,e))};return a}();a.TileClipper=q;q=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};a.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,e){this.line&&this.lines.push(this.line);this.line=[];var c=this._ratio;this.line.push(new b.Point(Math.round(a*
c),Math.round(e*c)))};a.prototype.lineTo=function(a,e){var c=this._ratio;this.line.push(new b.Point(Math.round(a*c),Math.round(e*c)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;3===this.type&&1!==this._ratio&&f.simplify(4096,64,this.lines);return this.lines};return a}();a.SimpleBuilder=q;var f=function(){function a(){}a.simplify=function(c,b,f){if(f){var d=
-b,e=c+b,h=-b,l=c+b;c=[];b=[];for(var m=f.length,n=0;n<m;++n){var p=f[n];if(p&&!(2>p.length))for(var q=p[0],B=void 0,C=p.length,y=1;y<C;++y)B=p[y],q.x===B.x&&(q.x<=d&&(q.y>B.y?(c.push(n),c.push(y),c.push(0),c.push(-1)):(b.push(n),b.push(y),b.push(0),b.push(-1))),q.x>=e&&(q.y<B.y?(c.push(n),c.push(y),c.push(1),c.push(-1)):(b.push(n),b.push(y),b.push(1),b.push(-1)))),q.y===B.y&&(q.y<=h&&(q.x<B.x?(c.push(n),c.push(y),c.push(2),c.push(-1)):(b.push(n),b.push(y),b.push(2),b.push(-1))),q.y>=l&&(q.x>B.x?
(c.push(n),c.push(y),c.push(3),c.push(-1)):(b.push(n),b.push(y),b.push(3),b.push(-1)))),q=B}0!==c.length&&0!==b.length&&(a.fillParent(f,b,c),a.fillParent(f,c,b),d=[],a.calcDeltas(d,b,c),a.calcDeltas(d,c,b),a.addDeltas(d,f))}};a.fillParent=function(a,b,f){for(var c=f.length,e=b.length,h=0;h<e;h+=4){for(var l=b[h],m=b[h+1],n=b[h+2],q=a[l][m-1],l=a[l][m],m=8092,J=-1,B=0;B<c;B+=4)if(f[B+2]===n){var C=f[B],y=f[B+1],v=a[C][y-1],C=a[C][y];switch(n){case 0:case 1:p.between(q.y,v.y,C.y)&&p.between(l.y,v.y,
C.y)&&(v=Math.abs(C.y-v.y),v<m&&(m=v,J=B));break;case 2:case 3:p.between(q.x,v.x,C.x)&&p.between(l.x,v.x,C.x)&&(v=Math.abs(C.x-v.x),v<m&&(m=v,J=B))}}b[h+3]=J}};a.calcDeltas=function(c,b,f){for(var d=b.length,e=0;e<d;e+=4){var h=a.calcDelta(e,b,f,[]);c.push(b[e]);c.push(b[e+1]);c.push(b[e+2]);c.push(h)}};a.calcDelta=function(c,b,f,d){c=b[c+3];if(-1===c)return 0;var e=d.length;if(1<e&&d[e-2]===c)return 0;d.push(c);return a.calcDelta(c,f,b,d)+1};a.addDeltas=function(a,b){for(var c=a.length,d=0,e=0;e<
c;e+=4){var f=a[e+3];f>d&&(d=f)}for(e=0;e<c;e+=4){var l=b[a[e]],m=a[e+1],f=d-a[e+3];switch(a[e+2]){case 0:l[m-1].x-=f;l[m].x-=f;break;case 1:l[m-1].x+=f;l[m].x+=f;break;case 2:l[m-1].y-=f;l[m].y-=f;break;case 3:l[m-1].y+=f,l[m].y+=f}}a=b.length;for(c=0;c<a;++c)l=b[c],!l||2>l.length||l[l.length-1].x!==l[0].x&&l[l.length-1].y!==l[0].y&&l.push(l[0])};return a}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(q,a){function b(a,b){a%=b;return 0<=a?a:a+b}
Object.defineProperty(a,"__esModule",{value:!0});a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var p=1/Math.LN2;a.positiveMod=b;a.radToByte=function(m){return b(m*a.C_RAD_TO_256,256)};a.degToByte=function(m){return b(m*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*p};a.sqr=function(a){return a*
a};a.clamp=function(a,b,l){return Math.min(Math.max(a,b),l)};a.interpolate=function(a,b,l){return a*(1-l)+b*l};a.between=function(a,b,l){return a>=b&&a<=l||a>=l&&a<=b}})},"esri/views/vectorTiles/Feature":function(){define(["require","exports","../2d/engine/webgl/Geometry"],function(q,a,b){return function(){function a(a,b){this.values={};var f=b.keys;for(b=b.values;a.next();)switch(a.tag()){case 1:this.id=a.getUInt64();break;case 2:for(var c=a.getMessage(),e=this.values;!c.empty();){var h=c.getUInt32(),
d=c.getUInt32();e[f[h]]=b[d]}break;case 3:this.type=a.getUInt32();break;case 4:this._pbfGeometry=a.getMessage();break;default:a.skip()}}a.prototype.getGeometry=function(a){if(void 0!==this._geometry)return this._geometry;var f=this._pbfGeometry,l,c;a?a.reset(this.type):l=[];for(var e=1,h=0,d=0,m=0;!f.empty();)switch(0===h&&(h=f.getUInt32(),e=h&7,h>>=3),h--,e){case 1:d+=f.getSInt32();m+=f.getSInt32();a?a.moveTo(d,m):(c&&l.push(c),c=[],c.push(new b.Point(d,m)));break;case 2:d+=f.getSInt32();m+=f.getSInt32();
a?a.lineTo(d,m):c.push(new b.Point(d,m));break;case 7:a?a.close():c&&!c[0].equals(d,m)&&c.push(c[0].clone());break;default:throw Error("Invalid path operation");}a?a=a.result():(c&&l.push(c),a=l);return this._geometry=a};return a}()})},"esri/views/vectorTiles/SourceLayerData":function(){define(["require","exports"],function(q,a){return function(){function a(b){this.extent=4096;this.keys=[];this.values=[];for(this._pbfLayer=b.clone();b.next();)switch(b.tag()){case 1:this.name=b.getString();break;case 3:this.keys.push(b.getString());
break;case 4:this.values.push(a._parseValue(b.getMessage()));break;case 5:this.extent=b.getUInt32();break;default:b.skip()}}a.prototype.getData=function(){return this._pbfLayer};a._parseValue=function(a){for(;a.next();)switch(a.tag()){case 1:return a.getString();case 2:return a.getFloat();case 3:return a.getDouble();case 4:return a.getInt64();case 5:return a.getUInt64();case 6:return a.getSInt64();case 7:return a.getBool();default:a.skip()}return null};return a}()})},"esri/views/vectorTiles/VertexMemoryBuffer":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./GeometryUtils ./MemoryBuffer".split(" "),
function(q,a,b,p,m,f){Object.defineProperty(a,"__esModule",{value:!0});var l=new Float32Array(1),c=new Uint32Array(l.buffer);q=function(a){function e(b){var c=a.call(this,b?20:12)||this;c._isDataDriven=b;return c}b(e,a);e.prototype.isDataDriven=function(){return this._isDataDriven};e.prototype.add=function(a,b,e,h,m,n,p,q){var d=this.array;a=f.i1616to32(a,b);d.push(a);a=f.i8888to32(Math.round(31*e),Math.round(31*h),Math.round(31*m),Math.round(31*n));d.push(a);a=f.i1616to32(p,0);d.push(a);if(this._isDataDriven){if(!q)throw Error("Expecting data driven values.");
e=q.color;h=e[3]*q.opacity*255;d.push(f.i8888to32(e[0]*h,e[1]*h,e[2]*h,h));l[0]=q.size;d.push(c[0])}};return e}(f);a.LineVertexBuffer=q;q=function(a){function c(b){var c=a.call(this,b?8:4)||this;c._isDataDriven=b;return c}b(c,a);c.prototype.isDataDriven=function(){return this._isDataDriven};c.prototype.add=function(a,b,c){var d=this.array;d.push(f.i1616to32(a,b));if(this._isDataDriven){if(!c)throw Error("Expecting data driven values.");a=c.color;c=a[3]*c.opacity*255;d.push(f.i8888to32(a[0]*c,a[1]*
c,a[2]*c,c))}};return c}(f);a.FillVertexBuffer=q;q=function(a){function c(b){var c=a.call(this,b?12:8)||this;c._isDataDriven=b;return c}b(c,a);c.prototype.isDataDriven=function(){return this._isDataDriven};c.prototype.add=function(a,b,c,e,h,l,m){var d=this.array,n=this.index;a=f.i1616to32(a,b);d.push(a);a=f.i8888to32(Math.round(15*c),Math.round(15*e),h,l);d.push(a);if(this._isDataDriven){if(!m)throw Error("Expecting data driven values.");c=m.color;m=c[3]*m.opacity*255;d.push(f.i8888to32(c[0]*m,c[1]*
m,c[2]*m,m))}return n};return c}(f);a.OutlineVertexBuffer=q;q=function(a){function e(b){var c=a.call(this,b?24:16)||this;c._isDataDriven=b;return c}b(e,a);e.prototype.isDataDriven=function(){return this._isDataDriven};e.prototype.add=function(a,b,e,h,p,n,q,J,B,C,y){var d=this.array;a=f.i1616to32(a,b);d.push(a);a=f.i1616to32(Math.round(8*e),Math.round(8*h));d.push(a);a=f.i8888to32(p/4,n/4,0,0);d.push(a);a=f.i8888to32(Math.ceil(10*C),m.radToByte(q),10*J,Math.min(10*B,255));d.push(a);if(this._isDataDriven){if(!y)throw Error("Expecting data driven values.");
e=y.color;h=e[3]*y.opacity*255;d.push(f.i8888to32(e[0]*h,e[1]*h,e[2]*h,h));l[0]=y.size;d.push(c[0])}};return e}(f);a.SymbolVertexBuffer=q;q=function(a){function c(){return a.call(this,16)||this}b(c,a);c.prototype.add=function(a,b,c,e,h,l,m,p,q,C,y){var d=this.array;a=f.i1616to32(2*a+c,2*b+e);d.push(a);m=l[3]*m*255;a=f.i8888to32(l[0]*m,l[1]*m,l[2]*m,m);d.push(a);l=C[3]*y*255;a=f.i8888to32(C[0]*l,C[1]*l,C[2]*l,l);d.push(a);a=f.i8888to32(Math.min(32*p,255),Math.min(4*q,255),Math.min(h,255),0);d.push(a)};
return c}(f);a.CircleVertexBuffer=q})},"esri/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","dojo/has","./StyleLayer"],function(q,a,b,p){return function(){function a(b,l){this.styleJSON=b;this.version=parseFloat(b.version);this.sprite=l?l.spriteUrl:b.sprite;this.glyphs=l?l.glyphsUrl:b.glyphs;this.layers=(b.layers||[]).map(a._create);this._identifyRefLayers()}a.prototype._identifyRefLayers=function(){for(var a=[],b=[],c=0,e=0,h=this.layers;e<h.length;e++){var d=h[e];
if(1===d.type){var m=d,p=d.sourceLayer,p=p+("|"+JSON.stringify(d.minzoom)),p=p+("|"+JSON.stringify(d.maxzoom)),p=p+("|"+JSON.stringify(d.filter));if(m.hasDataDrivenFill||m.hasDataDrivenOutline)p+="|"+JSON.stringify(c);a.push({key:p,layer:d})}2===d.type&&(m=d,p=d.sourceLayer,p+="|"+JSON.stringify(d.minzoom),p+="|"+JSON.stringify(d.maxzoom),p+="|"+JSON.stringify(d.filter),p+="|"+JSON.stringify(d.layout&&d.layout["line-cap"]),p+="|"+JSON.stringify(d.layout&&d.layout["line-join"]),m.hasDataDrivenLine&&
(p+="|"+JSON.stringify(c)),b.push({key:p,layer:d}));++c}this._assignRefLayers(a);this._assignRefLayers(b)};a.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b,c,e=a.length,f=0;f<e;f++){var d=a[f];if(d.key===b)d.layer.refLayerId=c;else if(b=d.key,c=d.layer.id,1===d.layer.type&&!d.layer.getPaintProperty("fill-outline-color"))for(var m=f+1;m<e;m++){var p=a[m];if(p.key===b){if(p.layer.getPaintProperty("fill-outline-color")){a[f]=p;a[m]=d;c=p.layer.id;
break}}else break}}};a._create=function(a,b,c){b=1-1/(c.length+1)*(1+b);switch(a.type){case "background":return new p.BackgroundStyleLayer(0,a,b);case "fill":return new p.FillStyleLayer(1,a,b);case "line":return new p.LineStyleLayer(2,a,b);case "symbol":return new p.SymbolStyleLayer(3,a,b);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new p.CircleStyleLayer(4,a,b)}throw Error("Unknown vector tile layer");};return a}()})},"*noref":1}});
define("require exports dojo/Deferred ../../core/promiseUtils ./WorkerTile ./style/StyleRepository".split(" "),function(q,a,b,p,m,f){return function(){function a(){this._tiles=new Map;this._spriteInfo={};this._glyphInfo={}}a.prototype.reset=function(){var a=new b;this._spriteInfo={};this._glyphInfo={};var e=this._tiles;e.forEach(function(a){return a.setObsolete()});e.clear();a.resolve();return a.promise};a.prototype.getLayers=function(){return this._layers};a.prototype.setLayers=function(a){this._layers=
(new f(a)).layers;return p.resolve({data:""})};a.prototype.getTile=function(a,b){var c=this,d=a.key,e=m.pool.acquire();e.initialize(a.key,a.refKey,this,a.rotation);var f=a.cacheTile;return b.invoke("fetchTileData",a.refKey).then(function(a){return e.setDataAndParse(a,b).then(function(a){f&&6!==e.status&&c._tiles.set(d,e);return a}).catch(function(a){e.setObsolete();m.pool.release(e);c._tiles["delete"](e.tileKey);return p.reject(a)})}).catch(function(a){e.setObsolete();if(c._tiles.has(e.tileKey))c._tiles["delete"](e.tileKey);
return p.reject(a)}).always(function(a){f||m.pool.release(e);return a})};a.prototype.update=function(a){var b=this._tiles.get(a.key);return b?b.updateSymbols(a.rotation):p.reject()};a.prototype.destructTileData=function(a){this._tiles.has(a)&&(m.pool.release(this._tiles.get(a)),this._tiles["delete"](a));return p.resolve()};a.prototype.fetchSprites=function(a,b){var c=[],d=this._spriteInfo;a.forEach(function(a){void 0===d[a]&&c.push(a)});return 0===c.length?p.resolve():b.invoke("getSprites",c).then(function(a){for(var b in a)d[b]=
a[b]})};a.prototype.getSpriteItems=function(){return this._spriteInfo};a.prototype.fetchGlyphs=function(a,b,f,d){var c=[],e=this._glyphInfo[b];e?f.forEach(function(a){e[a]||c.push(a)}):(e=this._glyphInfo[b]=[],f.forEach(function(a){return c.push(a)}));return 0===c.length?p.resolve():d.invoke("getGlyphs",{tileID:a,font:b,codePoints:c}).then(function(a){for(var b in a)e[b]=a[b]})};a.prototype.getGlyphItems=function(a){return this._glyphInfo[a]};return a}()});