// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../layers/BaseElevationLayer ../../../layers/BaseTileLayer ../../../layers/ElevationLayer ../../../layers/TiledLayer ../../../layers/TileLayer ../../../layers/VectorTileLayer ../../../layers/WMTSLayer ../../../support/basemapDefinitions ./terrainUtilsPlanar ./terrainUtilsSpherical".split(" "),function(B,b,u,v,w,x,y,h,k,l,z,A){function m(a){return a&&"esri.views.3d.layers.TileLayerView3D"===a.declaredClass}function n(a){return a&&"esri.views.3d.layers.VectorTileLayerView3D"===
a.declaredClass}function p(a){return a&&"esri.views.3d.layers.WMTSLayerView3D"===a.declaredClass}function q(a){return a&&"esri.views.3d.layers.ElevationLayerView3D"===a.declaredClass}function r(){e={};for(var a in l)l[a].baseMapLayers.forEach(function(a){e[a.url]=19});e["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=20}function g(a,b,f,d){return t["local"===d||"planar"===d?"planar":"spherical"].checkIfTileInfoSupportedForViewSR(a,b,f)}Object.defineProperty(b,"__esModule",
{value:!0});var t={planar:z,spherical:A};b.weakAssert=function(a,b){a||console.warn("Terrain: "+b)};b.autoUpdateSkirtsVisibility=function(a,b,f){var d=t[a.manifold],c,e=d.isInsideExtent(a,b);e?c=d.getElevation(a,b):(c=a.getElevationBounds(),c=.5*(c[0]+c[1]));c=d.getCameraElevation(b)-c;f=.9*Math.abs(c)<f?0:0>c?-1:1;e||(d.isInsideExtent(a,b,a.hideSkirtsDistanceFromExtentMargin)?(b=d.tiltToExtentEdge(a,b),b>a.hideSkirtsMinimumCameraTilt&&b<a.hideSkirtsMaximumCameraTilt&&(f=0)):f=0);a.skirtScale=f};
b.isTiledLayer=function(a){return a&&(a.isInstanceOf(x)||a.isInstanceOf(v)||a.isInstanceOf(u)||a.isInstanceOf(k))};b.isVectorTileLayer=function(a){return a&&a.isInstanceOf(h)};b.isTileLayerView=m;b.isVectorTileLayerView=n;b.isWMTSLayerView=p;b.isElevationLayerView=q;b.isTiledLayerView=function(a){return a&&(m(a)||q(a)||n(a)||p(a))};b.useFetchTileForLayer=function(a){return a.fetchTile&&!(a.fetchTile===y.prototype.fetchTile||a.fetchTile===w.prototype.fetchTile)};var e=null;b.getKnownTiledServiceLevelCap=
function(a){e||r();a=a&&a.replace(/https?:/,"");return a in e?e[a]:Infinity};b.prepareKnownTiledServiceLevelCaps=r;b.checkIfTileInfoSupportedForView=g;b.getTiledLayerInfo=function(a,b,f){var d,c;if(a.isInstanceOf(k)){if(a=a.activeLayer){var e=a.tileMatrixSet;if(e)d=e.tileInfo,c=e.fullExtent;else if(a=a.tileMatrixSets)if(a=a.find(function(a){return null==g(a.tileInfo,a.fullExtent,b,f)}))return{tileInfo:a.tileInfo,fullExtent:a.fullExtent}}}else d=a.isInstanceOf(h)?a.compatibleTileInfo256:a.tileInfo,
c=a.fullExtent;return d&&c&&null==g(d,c,b,f)?{tileInfo:d,fullExtent:c}:{tileInfo:null,fullExtent:null}}});